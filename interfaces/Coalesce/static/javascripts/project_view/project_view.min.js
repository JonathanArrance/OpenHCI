$(function(){var e=$("#fip_progressbar"),s=$("#fip_list"),a='<tr id="fip_placeholder"><td><p><i>This project has no floating IPs</i></p></td><td></td><td></td></tr>';$("#allocate_ip").click(function(a){a.preventDefault(),message.showMessage("notice","Allocating IP."),disableLinks(!0),setVisible("#allocate_ip",!1),setVisible("#assign_ip",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"fips",!1),$.getJSON("/allocate_floating_ip/"+PROJECT_ID+"/"+extNet+"/").done(function(e){if("error"==e.status&&message.showMessage("error","No available IPs.  If you just deallocated an IP, wait a few minutes and try again."),"success"==e.status){message.showMessage("success","Successfully allocated "+e.ip_info.floating_ip+".");var a='<tr id="'+e.ip_info.floating_ip_id+'"><td id="'+e.ip_info.floating_ip_id+'-ip-cell"><a href="/floating_ip/'+e.ip_info.floating_ip_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.ip_info.floating_ip_id+'-ip-address">'+e.ip_info.floating_ip+'</span></a></td><td id="'+e.ip_info.floating_ip_id+'-instance-cell"><span id="'+e.ip_info.floating_ip_id+'-instance-name">None</span></td><td id="'+e.ip_info.floating_ip_id+'-actions-cell"><a href="#" " class="deallocate_ip">deallocate</a></td></tr>',t=$("#fip_list tr").length;2>=t&&$("#fip_placeholder").remove().fadeOut(),$(s).append(a).fadeIn(),addToSelect(e.ip_info.floating_ip_id,e.ip_info.floating_ip,$("#assign_floating_ip"),assignableFips)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){checkAssignFip(),disableProgressbar(e,"fips",!0),setVisible("#allocate_ip",!0),disableLinks(!1)})}),$(function(){var t,n,o;$(document).on("click",".deallocate_ip",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=$(document.getElementById(t+"-ip-address")).text(),$("div#fip-deallocate-confirm-form > p > span.ip-address").empty().append(n),$("#fip-deallocate-confirm-form").dialog("open")}),$("#fip-deallocate-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=t,r=n,l=o;message.showMessage("notice","Deallocating "+r+".");var d=document.getElementById(i+"-actions-cell"),c='<a class="deallocate_ip" href="#">deallocate</a></td>';disableLinks(!0),disableActions("deallocate_ip",!0),setVisible("#allocate_ip",!1),setVisible("#assign_ip",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"fips",!1);var p=i+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn(),$.getJSON("/deallocate_floating_ip/"+PROJECT_ID+"/"+r+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message),$(l).fadeOut().remove();var t=$("#fip_list tr").length;2>t&&$(s).append(a).fadeIn(),removeFromSelect(i,$("#assign_floating_ip"),assignableFips)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){checkAssignFip(),disableProgressbar(e,"fips",!0),setVisible("#allocate_ip",!0),disableActions("deallocate_ip",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s=$("#assign_floating_ip"),a=$("#assign_instance");$("#assign_ip").click(function(e){e.preventDefault(),$("#fip-assign-dialog-form").dialog("open")}),$("#fip-assign-dialog-form").dialog({autoOpen:!1,height:265,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Assign:function(){var t=s.val(),n=$(document.getElementById(t+"-ip-address")).text(),o=a.val(),i=document.getElementById(t);disableLinks(!0),setVisible("#allocate_ip",!1),setVisible("#assign_ip",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"fips",!1),$.getJSON("/assign_floating_ip/"+n+"/"+o+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var t=document.getElementById(e.floating_ip_id+"-instance-cell"),n=document.getElementById(e.floating_ip_id+"-actions-cell"),r='<span id="'+e.floating_ip_id+'-instance-name">'+e.instance_name+"</span>",l='<a href="#" id="'+e.floating_ip_id+'" class="unassign_ip">unassign</a>';$(t).empty().fadeOut(),$(n).empty().fadeOut(),$(t).append(r).fadeIn(),$(n).append(l).fadeIn(),removeFromSelect(e.floating_ip_id,s,assignableFips),removeFromSelect(o,a,assignableInstances),$(i).addClass("fip-assigned")}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){checkAssignFip(),disableProgressbar(e,"fips",!0),setVisible("#allocate_ip",!0),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t,n,o;$(document).on("click",".unassign_ip",function(e){e.preventDefault(),s=$(this).parent().parent(),t=$(s).attr("id"),a=$(document.getElementById(t+"-ip-address")).text(),n=$(document.getElementById(t+"-instance-name")).text(),o=$("a").filter(function(){return $(this).text()==n}),o=$(o).parent().parent().attr("id"),$("div#fip-unassign-confirm-form > p > span.ip-address").empty().append(a),$("#fip-unassign-confirm-form").dialog("open")}),$("#fip-unassign-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:window},buttons:{Confirm:function(){var i=a,r=t,l=o,d=n;message.showMessage("notice","Unassigning "+i+".");var c=document.getElementById(r+"-actions-cell"),p=c.innerHTML;disableLinks(!0),disableActions("unassign_ip",!0),setVisible("#assign_ip",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"fips",!1);var u=r+"-loader",m='<div class="ajax-loader" id="'+u+'"></div>';$(c).empty().fadeOut(),$(c).append(m).fadeIn(),$.getJSON("/unassign_floating_ip/"+r+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(c).empty().fadeOut(),$(c).append(p)),"success"==e.status){message.showMessage("success",e.message);var a=document.getElementById(e.floating_ip_id+"-instance-cell"),t='<span id="'+e.floating_ip_id+'-instance-name">None</span>',n='<a href="#" class="deallocate_ip">deallocate</a>';$(a).empty().fadeOut(),$(c).empty().fadeOut(),$(a).append(t).fadeIn(),$(c).append(n).fadeIn(),addToSelect(e.floating_ip_id,e.floating_ip,$("#assign_floating_ip"),assignableFips),addToSelect(l,d,$("#assign_instance"),assignableInstances),$(s).removeClass("fip-assigned")}}).fail(function(){message.showMessage("error","Server Fault"),$(c).empty().fadeOut(),$(c).append(p)}).always(function(){checkAssignFip(),disableProgressbar(e,"fips",!0),setVisible("#assign_ip",!0),disableActions("unassign_ip",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})})}),$(function(){function e(e){var s=$("#image-import-dialog-form").find("#upload_bar"),a=$("#image-import-dialog-form").find("#upload_percent");0!=n&&clearInterval(n),n=setInterval(function(){$.getJSON("/get_upload_progress/"+e,function(e){if("error"==e.status)return message.showMessage("error",e.message),clearInterval(n),void(n=0);if(-1==e.length)return t="100%",s.width(t),a.html(t),clearInterval(n),void(n=0);if(length=parseInt(e.length),length>0)var t=Math.floor(100*parseInt(e.uploaded)/length);else var t=0;t+="%",s.width(t),a.html(t)})},1e3)}var s=$("#image_progressbar"),a=$("#image_list"),t='<tr id="#image_placeholder"><td><p><i>This project has no image</i></p></td><td></td></tr>';$(function(){var s=!1,a=$("#import_img_name"),t=$("#import_img_disk"),n=$("#import_img_cont"),o=$("#import_img_type"),i=$("#import_local"),r=$("#import_remote"),l=$("#os_type"),d=$("#import_img_vis"),c="",p=$([]).add(a).add(t).add(n).add(o).add(i).add(r).add(c).add(d);$("#import-image").click(function(e){e.preventDefault(),$("#image-import-dialog-form").dialog("open")}),$("#image-import-dialog-form").dialog({autoOpen:!1,height:575,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Import Image":function(){if(!s&&(clearUiValidation(p),checkLength(a,"image_name",3,20))){var u=guid(),m=a.val();if("image_url"==o.val()){if(!checkUrl(r))return;disableFormInputs("image",["text","select","file"],!0),disableLinks(!0),e(u),c=r;var g=c.val();c=convertUrl47(c),g=g.replace(/\//g,"&47");var f=l.val();h="/import_remote/"+a.val()+"/"+n.val()+"/"+t.val()+"/"+o.val()+"/"+g+"/"+d.val()+"/"+f+"/"+u+"/",s=!0;var v=new FormData($("#image-upload-form")[0]);$.ajax({type:"POST",url:h,data:v,contentType:!1,cache:!1,processData:!1,async:!0,success:function(e){var a=JSON.parse(e);if("error"==a.status)return void message.showMessage("error",a.message);var t='<tr id="'+a.image_id+'"><td id="'+a.image_id+'-name-cell"><span id="'+a.image_id+'-name-text">'+m+'</span></td><td id="'+a.image_id+'-actions-cell"><a href="#" class="delete-image">delete</a></td></tr>';console.log("success: image_id:"+a.image_id),$("#image_list").append(t),addToSelect(m,m,$("#image_name"),imageInstOpts),message.showMessage("success",a.message),$("#image-import-dialog-form").dialog("close"),disableFormInputs("image",["text","select","file"],!1),disableLinks(!1),s=!1,resetUiValidation(p)},error:function(){message.showMessage("error","Server Fault"),$("#image-import-dialog-form").dialog("close"),disableFormInputs("image",["text","select","file"],!1),disableLinks(!1),s=!1,resetUiValidation(p)}})}else{if(!checkFile(i))return;disableUiButtons(".ui-dialog-titlebar-close",!1),disableLinks(!0),g="na";var f=l.val(),h="/import_local/"+a.val()+"/"+n.val()+"/"+t.val()+"/"+o.val()+"/"+g+"/"+d.val()+"/"+f+"/"+u+"/";s=!0;var v=new FormData($("#image-upload-form")[0]);$.ajax({type:"POST",url:h,data:v,contentType:!1,cache:!1,processData:!1,async:!0,xhr:function(){var e=$("#image-import-dialog-form").find("#upload_bar"),s=$("#image-import-dialog-form").find("#upload_percent");disableFormInputs("image",["text","select","file"],!0);var a=$.ajaxSettings.xhr();return a.upload.onprogress=function(a){if(a.lengthComputable){var t=Math.floor(100*parseInt(a.loaded)/parseInt(a.total));t+="%",e.width(t),s.html(t)}},a},success:function(e){var a=JSON.parse(e);if("error"==a.status)return void message.showMessage("error",a.message);var t='<tr id="'+a.image_id+'"><td id="'+a.image_id+'-name-cell"><span id="'+a.image_id+'-name-text">'+m+'</span></td><td id="'+a.image_id+'-actions-cell"><a href="#" class="delete-image">delete</a></td></tr>';console.log("success: image_id:"+a.image_id),$("#image_list").append(t),addToSelect(m,m,$("#image_name"),imageInstOpts),message.showMessage("success",a.message),$("#image-import-dialog-form").dialog("close"),disableFormInputs("image",["text","select","file"],!1),disableLinks(!1),s=!1,resetUiValidation(p)},error:function(){message.showMessage("error","Server Fault"),$("#image-import-dialog-form").dialog("close"),disableFormInputs("image",["text","select","file"],!1),disableLinks(!1),s=!1,resetUiValidation(p)}})}}}},close:function(){s||resetUiValidation(p)}})});var n=0;$(function(){var e,n,o;$(document).on("click",".delete-image",function(s){s.preventDefault(),o=$(this).parent().parent(),e=$(o).attr("id"),n=document.getElementById(e+"-name-text"),$("div#image-delete-confirm-form > p > span.image-name").empty().append($(n).text()),$("#image-delete-confirm-form").dialog("open")}),$("#image-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=e,r=$(n).text();message.showMessage("notice","Deleting "+r+".");var l=document.getElementById(i+"-actions-cell"),d=l.innerHTML;disableLinks(!0),disableActions("delete-image",!0),$(s).progressbar({value:!1}),disableProgressbar(s,"images",!1);var c=i+"-loader",p='<div class="ajax-loader" id="'+c+'"></div>';$(l).empty().fadeOut(),$(l).append(p).fadeIn(),$.getJSON("/delete_image/"+i+"/").done(function(e){"error"==e.status&&(message.showMessage("error",e.message),$(l).empty().fadeOut(),$(l).append(d).fadeIn()),"success"==e.status&&(message.showMessage("success",e.message),$(o).fadeOut().remove(),removeFromSelect(r,$("#image_name"),imageInstOpts));var s=$("#image_list tr").length;2>s&&$(a).append(t).fadeIn()}).fail(function(){message.showMessage("error","Server Fault"),$(l).empty().fadeOut(),$(l).append(d).fadeIn()}).always(function(){disableProgressbar(s,"images",!0),disableLinks(!1),disableActions("delete-image",!1)}),$(this).dialog("close")}},close:function(){}})})}),$(function(){var e=$("#instance_progressbar"),s=$("#instance_list"),a='<tr id="instance_placeholder"><td><p><i>This project has no instances</i></p></td><td></td><td></td><td></td></tr>';$(function(){var a=$("#name"),t=$("#sec_group_name"),n=$("#sec_key_name"),o=$("#network_name"),i=$("#image_name"),r=$("#flavor_name"),l=$([]).add(t).add(n).add(i).add(a).add(o);$("#create-instance").click(function(e){e.preventDefault(),$("#instance-dialog-form").dialog("open")}),$("#instance-dialog-form").dialog({autoOpen:!1,height:505,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Instance":function(){clearUiValidation(l);var d=checkLength(a,"Instance Name",3,16)&&checkDuplicateName(a,instanceOpts);if(d){var c=a.val(),p=t.val(),u=n.val(),m=o.val(),g=i.val(),f=r.val();message.showMessage("notice","Creating New Instance "+c),setVisible("#create-instance",!1),disableLinks(!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1),$.getJSON("/create_image/"+c+"/"+p+"/nova/"+f+"/"+u+"/"+g+"/"+m+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a='<tr id="'+e.server_info.server_id+'"><td id="'+e.server_info.server_id+'-name-cell"><a href="/'+PROJECT_ID+"/"+e.server_info.server_id+'/instance_view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.server_info.server_id+'-name-text">'+e.server_info.server_name+'</span></a></td><td id="'+e.server_info.server_id+'-status-cell">'+e.server_info.server_status+'</td><td id="'+e.server_info.server_id+'-os-cell">'+e.server_info.server_os+" / "+e.server_info.server_flavor+'</td><td id="'+e.server_info.server_id+'-actions-cell">';"ACTIVE"==e.server_info.server_status&&(a+='<a href="'+e.server_info.novnc_console+'" class="open-instance-console" onClick="window.open(this.href,\'_blank\',\'toolbar=no, location=no, status=no, menubar=no, titlebar = no, scrollbars=yes, resizable=yes, width=720, height=435\'); return false;">console</a><span class="instance-actions-pipe"> | </span><a href="#" class="pause-instance '+e.server_info.server_id+'-disable-action">pause</a><span class="instance-actions-pipe"> | </span><a href="#" class="suspend-instance '+e.server_info.server_id+'-disable-action">suspend</a>'),"PAUSED"==e.server_info.server_status&&(a+='<a href="#" class="unpause-instance '+e.server_info.server_id+'-disable-action">unpause</a>'),"SUSPENDED"==e.server_info.server_status&&(a+='<a href="#" class="resume-instance '+e.server_info.server_id+'-disable-action">resume</a>'),a+='<span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+e.server_info.server_id+'-disable-action">delete</a></td></tr>';var t=$("#instance_list tr").length;t>=2&&($("#instance_placeholder").remove().fadeOut(),setVisible("#create-instance-snapshot",!0)),$(s).append(a).fadeIn(),instances.setItem(e.server_info.server_id,{id:e.server_info.server_id,name:e.server_info.server_name,status:e.server_info.server_status,flavor:e.server_info.server_flavor,os:e.server_info.server_os,console:e.server_info.novnc_console}),consoleLinks.setItem(e.server_info.server_id,{link:e.server_info.novnc_console,html:'<a href="'+e.server_info.novnc_console+'" class="open-instance-console" onClick="window.open(this.href,\'_blank\',\'toolbar=no, location=no, status=no, menubar=no, titlebar = no, scrollbars=yes, resizable=yes, width=720, height=435\'); return false;">console</a>'}),addToSelect(e.server_info.server_id,e.server_info.server_name,$("#instance"),attachableInstances),addToSelect(e.server_info.server_id,e.server_info.server_name,$("#assign_instance"),assignableInstances),addToSelect(e.server_info.server_id,e.server_info.server_name,$("#instance_to_snap"),instanceOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){checkAssignFip(),disableProgressbar(e,"instances",!0),setVisible("#create-instance",!0),disableLinks(!1),resetUiValidation(l)}),$(this).dialog("close")}}},close:function(){resetUiValidation(l)}})}),$(function(){var t,n,o;$(document).on("click",".delete-instance",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=document.getElementById(t+"-name-text"),$("div#instance-delete-confirm-form > p > span.instance-name").empty().append($(n).text()),$("#instance-delete-confirm-form").dialog("open")}),$("#instance-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=o,r=t,l=$(n).text();message.showMessage("notice","Deleting "+l+".");var d=document.getElementById(r+"-actions-cell"),c=d.innerHTML;disableLinks(!0),disableActions("delete-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var p=r+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+r+"/delete_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message),$(i).fadeOut().remove(),removeFromSelect(r,$("#instance"),attachableInstances),removeFromSelect(r,$("#assign_instance"),assignableInstances),(assignableFips.length<=0||assignableInstances.length<=0)&&setVisible("#assign_ip",!1);for(var t=0;t<e.vols.length;t++){var n=document.getElementById(e.vols[t]+"-attached-cell");$(n).empty().fadeOut(),$(n).parent().removeClass("volume-attached");var o='<span id="'+e.vols[t]+'-attached-placeholder">No Attached Instance</span>';$(n).append(o).fadeIn();var l=document.getElementById(e.vols[t]+"-actions-cell");$(l).empty().fadeOut();var p='<a href="#" class="attach-volume">attach</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a>';$(l).append(p).fadeIn()}for(var u=0;u<e.floating_ip.length;u++){var m=document.getElementById(e.floating_ip_id[u]+"-instance-cell");$(m).empty().fadeOut(),$(m).parent().removeClass("fip-assigned");var g='<span id="'+e.floating_ip[u]+'-instance-name">None</span>';$(m).append(g).fadeIn();var f=document.getElementById(e.floating_ip_id[u]+"-actions-cell");$(f).empty().fadeOut();var v='<a id="'+e.floating_ip_id[u]+'" class="deallocate_ip" href="#">deallocate</a>';$(f).append(v).fadeIn()}instances.removeItem(r),instanceOpts.removeItem(r),refreshSelect("#instance_to_snap",instanceOpts);var h=$("#instance_list tr").length;2>h&&($(s).append(a).fadeIn(),setVisible("#create-instance-snapshot",!1))}}).fail(function(){message.showMessage("error","Server Fault"),$(d).empty().fadeOut(),$(d).append(c).fadeIn()}).always(function(){checkAssignFip(),disableProgressbar(e,"instances",!0),disableActions("delete-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t;$(document).on("click",".pause-instance",function(e){e.preventDefault(),t=$(this).parent().parent(),s=$(t).attr("id"),a=document.getElementById(s+"-name-text"),$("div#instance-pause-confirm-form > p > span.instance-name").empty().append($(a).text()),$("#instance-pause-confirm-form").dialog("open")}),$("#instance-pause-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=s,o=$(a).text();message.showMessage("notice","Pausing "+o+".");var i=document.getElementById(n+"-actions-cell"),r=i.innerHTML;disableLinks(!0),disableActions("pause-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var l=n+"-loader",d='<div class="ajax-loader" id="'+l+'"></div>';$(i).empty().fadeOut(),$(i).append(d).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+n+"/pause_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(i).empty().fadeOut(),$(i).append(r).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(n+"-status-cell");$(s).fadeOut().empty(),$(s).append("PAUSED").fadeIn();var a='<a href="#" class="unpause-instance '+n+'-disable-action">unpause</a><span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+n+'-disable-action">delete</a>';$(i).fadeOut().empty(),$(i).append(a).fadeIn(),$(t).addClass("instance-paused"),instances.items[n].status="PAUSED"}}).fail(function(){message.showMessage("error","Server Fault"),$(i).empty().fadeOut(),$(i).append(r).fadeIn()}).always(function(){disableProgressbar(e,"instances",!0),disableActions("pause-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t;$(document).on("click",".unpause-instance",function(e){e.preventDefault(),t=$(this).parent().parent(),s=$(t).attr("id"),a=document.getElementById(s+"-name-text"),$("div#instance-unpause-confirm-form > p > span.instance-name").empty().append($(a).text()),$("#instance-unpause-confirm-form").dialog("open")}),$("#instance-unpause-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=s,o=$(a).text(),i=consoleLinks.items[n].html;message.showMessage("notice","Unpausing "+o+".");var r=document.getElementById(n+"-actions-cell"),l=r.innerHTML;disableLinks(!0),disableActions("unpause-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var d=n+"-loader",c='<div class="ajax-loader" id="'+d+'"></div>';$(r).empty().fadeOut(),$(r).append(c).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+n+"/unpause_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(l).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(n+"-status-cell");$(s).fadeOut().empty(),$(s).append("ACTIVE").fadeIn();var a=i+'<span class="instance-actions-pipe"> | </span><a href="#" class="pause-instance '+n+'-disable-action">pause</a><span class="instance-actions-pipe"> | </span><a href="#" class="suspend-instance '+n+'-disable-action">suspend</a><span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+n+'-disable-action">delete</a>';$(r).fadeOut().empty(),$(r).append(a).fadeIn(),$(t).removeClass("instance-paused"),instances.items[n].status="ACTIVE"}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(l).fadeIn()}).always(function(){disableProgressbar(e,"instances",!0),disableActions("unpause-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t;$(document).on("click",".suspend-instance",function(e){e.preventDefault(),t=$(this).parent().parent(),s=$(t).attr("id"),a=document.getElementById(s+"-name-text"),$("div#instance-suspend-confirm-form > p > span.instance-name").empty().append($(a).text()),$("#instance-suspend-confirm-form").dialog("open")}),$("#instance-suspend-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=s,o=$(a).text();message.showMessage("notice","Suspending "+o+".");var i=document.getElementById(n+"-actions-cell"),r=i.innerHTML;disableLinks(!0),disableActions("suspend-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var l=n+"-loader",d='<div class="ajax-loader" id="'+l+'"></div>';$(i).empty().fadeOut(),$(i).append(d).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+n+"/suspend_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(i).empty().fadeOut(),$(i).append(r).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(n+"-status-cell");$(s).fadeOut().empty(),$(s).append("SUSPENDED").fadeIn();var a='<a href="#" class="resume-instance '+n+'-disable-action">resume</a><span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+n+'-disable-action">delete</a>';$(i).fadeOut().empty(),$(i).append(a).fadeIn(),$(t).addClass("instance-suspended"),instances.items[n].status="SUSPENDED"}}).fail(function(){message.showMessage("error","Server Fault"),$(i).empty().fadeOut(),$(i).append(r).fadeIn()}).always(function(){disableProgressbar(e,"instances",!0),disableActions("suspend-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t;$(document).on("click",".resume-instance",function(e){e.preventDefault(),t=$(this).parent().parent(),s=$(t).attr("id"),a=document.getElementById(s+"-name-text"),$("div#instance-resume-confirm-form > p > span.instance-name").empty().append($(a).text()),$("#instance-resume-confirm-form").dialog("open")}),$("#instance-resume-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=s,o=$(a).text(),i=consoleLinks.items[n].html;message.showMessage("notice","Resuming "+o+".");var r=document.getElementById(n+"-actions-cell"),l=r.innerHTML;disableLinks(!0),disableActions("resume-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var d=n+"-loader",c='<div class="ajax-loader" id="'+d+'"></div>';$(r).empty().fadeOut(),$(r).append(c).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+n+"/resume_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(l).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(n+"-status-cell");$(s).fadeOut().empty(),$(s).append("ACTIVE").fadeIn();var a=i+'<span class="instance-actions-pipe"> | </span><a href="#" class="pause-instance '+n+'-disable-action">pause</a><span class="instance-actions-pipe"> | </span><a href="#" class="suspend-instance '+n+'-disable-action">suspend</a><span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+n+'-disable-action">delete</a>';$(r).fadeOut().empty(),$(r).append(a).fadeIn(),$(t).removeClass("instance-suspended"),instances.items[n].status="ACTIVE"}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(l).fadeIn()}).always(function(){disableProgressbar(e,"instances",!0),disableActions("resume-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})})}),$(function(){var e=$("#keypair_progressbar"),s=$("#keypair_list"),a='<tr id="#keypair_placeholder"><td><p><i>You have no keys defined</i></p></td><td></td><td></td></tr>';$(function(){var a=$("#key_name"),t=$([]).add(a);$("#create-keypair").click(function(e){e.preventDefault(),$("#keypair-dialog-form").dialog("open")}),$("#keypair-dialog-form").dialog({autoOpen:!1,height:225,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Key Pair":function(){clearUiValidation(t);var n=checkLength(a,"key name",3,16);if(n){var o=a.val();message.showMessage("notice","Creating new Key "+o),setVisible("#create-keypair",!1),disableLinks(!0),$(e).progressbar({value:!1}),setVisible(e,!0),$.getJSON("/create_sec_keys/"+o+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a="";a+='<tr id="'+e.key_id+'"><td id="'+e.key_id+'-name-cell"><a href="/key_pair/'+e.key_id+"/"+PROJECT_ID+'/view/" class="disable-link" style="color:#696969;"><span id="'+e.key_id+'-name-text">'+e.key_name+'</span></a></td><td id="'+e.key_id+'-user-cell"><span id="'+e.key_id+'-user-text">'+USERNAME+'</span></td><td id="'+e.key_id+'-actions-cell"><a href="#" class="delete-keypair">delete</a></td></tr>';var t=$("#keypair_list tr").length;2>=t&&$("#keypair_placeholder").remove().fadeOut(),s.append(a).fadeIn(),addToSelect(e.key_name,e.key_name,$("#sec_key_name"),secKeyInstOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){setVisible(e,!1),setVisible("#create-keypair",!0),disableLinks(!1),resetUiValidation(t)}),$(this).dialog("close")}}},close:function(){resetUiValidation(t)}})}),$(function(){var s,t="",n="";$(document).on("click",".delete-keypair",function(e){e.preventDefault(),s=$(this).parent().parent(),t=$(s).attr("id"),n=document.getElementById(t+"-name-text"),$("div#keypair-delete-confirm-form > p > span.keypair-name").empty().append($(n).text()),$("#keypair-delete-confirm-form").dialog("open")}),$("#keypair-delete-confirm-form").dialog({autoOpen:!1,height:125,width:200,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var o=t,i=$(n).text(),r=document.getElementById(o+"-actions-cell"),l=r.innerHTML;message.showMessage("notice","Deleting "+i+"."),disableLinks(!0),$(e).progressbar({value:!1}),setVisible(e,!0);var d=o+"-loader",c='<div class="ajax-loader" id="'+d+'"></div>';$(r).empty().fadeOut(),$(r).append(c).fadeIn(),$.getJSON("/key_pair/"+i+"/"+PROJECT_ID+"/delete/").done(function(e){"error"==e.status&&(message.showMessage("error",e.message),console.log(e),$(r).empty().fadeOut(),$(r).append(l).fadeIn()),"success"==e.status&&(message.showMessage("success",e.message),$(s).fadeOut().remove(),removeFromSelect(i,$("#sec_key_name"),secKeyInstOpts));var t=$("#keypair_list tr").length;2>t&&$("#keypair_list").append(a).fadeIn()}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(l).fadeIn()}).always(function(){disableLinks(!1),setVisible(e,!1)}),$(this).dialog("close")}},close:function(){}})})}),$(function(){var e=$("#privateNet_progressbar"),s=$("#privateNet_list"),a='<tr id="privateNet_placeholder"><td><p><i>This project has no privateNets</i></p></td><td></td><td></td><td></td></tr>';$(function(){$("#privateNet_placeholder").length&&setVisible("#create-router",!1)}),$(function(){var a=$("#privateNet_name"),t=$("#admin_state"),n=$("#shared"),o=$([]).add(a).add(t).add(n);$("#create-private-network").click(function(e){e.preventDefault(),$("#private-network-dialog-form").dialog("open")}),$("#private-network-dialog-form").dialog({autoOpen:!1,height:350,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Private Network":function(){clearUiValidation(o);var i=checkLength(a,"Network Name",3,16)&&checkDuplicateName(a,privateNetworks);if(i){var r=a.val(),l=n.val(),d=t.val();message.showMessage("notice","Creating new network "+r),disableLinks(!0),setVisible("#create-private-network",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"privateNets",!1),$.getJSON("/add_private_network/"+r+"/"+d+"/"+l+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a='<tr id="'+e.net_id+'"><td id="'+e.net_id+'-name-cell"><a href="/network/'+e.net_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.net_id+'-name-text">'+e.net_name+'</span></a></td><td id="'+e.net_id+'-status-cell">shared: <span id="'+e.net_id+'-shared-text">'+l+'</span><span id="{{ value.net_id }}-status-pipe"> | </span>admin state: <span id="'+e.net_id+'-admin-text">'+d+'</span></td><td id="'+e.net_id+'-subnet-cell"><span id="'+e.subnet.subnet_id+'">'+e.subnet.subnet_name+'</span></td><td id="'+e.net_id+'-actions-cell"><a href="#" class="delete-privateNet">delete</a></td></tr>';s.append(a).fadeIn();var t=$("#privateNet_list tr").length;t>2&&$("#privateNet_placeholder").remove().fadeOut(),privateNetworks.setItem(e.net_id,{id:e.net_id,name:e.net_name,router:"None"}),addToSelect(e.net_name,e.net_name,$("#network_name"),privNetInstOpts),addToSelect(e.net_id,e.net_name,$("#priv_net"),privNetRoutOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"privateNets",!0),setVisible("#create-private-network",!0),disableLinks(!1),resetUiValidation(o),checkCreateRouter()}),$(this).dialog("close")}}},close:function(){resetUiValidation(o)}})}),$(function(){var t,n,o;$(document).on("click",".delete-privateNet",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=document.getElementById(t+"-name-text"),$("div#private-network-delete-confirm-form > p > span.privateNet-name").empty().append($(n).text()),$("#private-network-delete-confirm-form").dialog("open")}),$("#private-network-delete-confirm-form").dialog({autoOpen:!1,height:150,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=t,r=$(n).text(),l=o;message.showMessage("notice","Deleting "+r+".");var d=document.getElementById(i+"-actions-cell"),c=d.innerHTML;disableLinks(!0),disableActions("delete-privateNet",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"privateNets",!1);var p=i+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn();var m=privateNetworks.items[i],g=m.router,f=$(document.getElementById(g));"None"!=g&&(f.addClass("router-deleted"),disableActions("delete-router",!0),$("#router_progressbar").progressbar({value:!1}),disableProgressbar("#router_progressbar","routers",!1)),$.getJSON("/delete_private_network/"+PROJECT_ID+"/"+i+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(c).fadeIn(),"None"!=g&&(checkCreateRouter(),disableProgressbar("#router_progressbar","routers",!0),disableActions("delete-router",!1),disableLinks(!1),f.removeClass("router-deleted"))),"success"==e.status){message.showMessage("success",e.message),l.fadeOut().remove();var t=$("#privateNet_list tr").length;2>t&&($(s).append(a).fadeIn(),setVisible($("#create-router"),!1)),"None"!=g&&$.getJSON("/delete_router/"+PROJECT_ID+"/"+g+"/").done(function(e){var s=g;if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message),f.fadeOut().remove();var a=$("#router_list tr").length;2>a&&$("#router_list").append('<tr id="router_placeholder"><td><p><i>This project has no routers</i></p></td><td></td><td></td></tr>').fadeIn(),routers.removeItem(s)}}).fail(function(){message.showMessage("error","Server Fault"),f.removeClass("router-deleted")}).always(function(){checkCreateRouter(),disableProgressbar("#router_progressbar","routers",!0),disableActions("delete-router",!1),disableLinks(!1)}),privateNetworks.removeItem(i),removeFromSelect(r,$("#network_name"),privNetInstOpts),removeFromSelect(i,$("#priv_net"),privNetRoutOpts)}}).fail(function(){message.showMessage("error","Server Fault"),$(d).empty().fadeOut(),$(d).append(c).fadeIn()}).always(function(){disableProgressbar(e,"privateNets",!0),disableActions("delete-privateNet",!1),"None"==g&&disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})})}),$(function(){$(function(){$("#delete-project").click(function(e){e.preventDefault(),$("#project-delete-confirm-form").dialog("open")}),$("#project-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){message.showMessage("notice","Deleting Project"),disableUiButtons(".ui-button",!0),$.getJSON("/projects/"+PROJECT_ID+"/"+PROJECT+"/delete/").done(function(e){"error"==e.status&&(message.showMessage("error",e.message),disableUiButtons(".ui-button",!1)),"success"==e.status&&(message.showMessage("success",e.message),location.replace("/cloud/manage"))}).fail(function(){disableUiButtons(".ui-button",!1)})}},close:function(){}})})}),$(function(){var e=$("#router_progressbar"),s=$("#router_list"),a='<tr id="router_placeholder"><td><p><i>This project has no routers</i></p></td><td></td><td></td></tr>';$(function(){var a=$("#router_name"),t=$("#priv_net"),n=$([]).add(a).add(t);$("#create-router").click(function(e){e.preventDefault(),$("#router-dialog-form").dialog("open")}),$("#router-dialog-form").dialog({autoOpen:!1,height:285,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Router":function(){clearUiValidation(n);var o=checkLength(a,"Router Name",3,16)&&checkDuplicateName(a,routers);if(o){var i=a.val(),r=t.val();message.showMessage("notice","Creating new router "+i),disableLinks(!0),setVisible("#create-router",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"routers",!1),$.getJSON("/create_router/"+i+"/"+r+"/"+DEFAULT_PUBLIC+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a='<tr id="'+e.router_id+'"><td id="'+e.router_id+'-name-cell"><a href="/router/'+e.router_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.router_id+'-name-text">'+e.router_name+'</span></a></td><td id="'+e.router_id+'-status-cell"><span id="'+e.router_id+'-status-text">ACTIVE</span></td><td id="'+e.router_id+'-actions-cell"><a href="#" class="delete-router">delete</a></td></tr>',t=$("#router_list tr").length;2>=t&&$("#router_placeholder").remove().fadeOut(),s.append(a).fadeIn(),routers.setItem(e.router_id,{name:e.router_name,network:r}),removeFromSelect(r,$("#priv_net"),privNetRoutOpts),privateNetworks.items[r].router=e.router_id}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"routers",!0),setVisible("#create-router",!0),disableLinks(!1),resetUiValidation(n)}),$(this).dialog("close")}}},close:function(){resetUiValidation(n)}})}),$(function(){var t,n,o;$(document).on("click",".delete-router",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=document.getElementById(t+"-name-text"),$("div#router-delete-confirm-form > p > span.router-name").empty().append($(n).text()),$("#router-delete-confirm-form").dialog("open")}),$("#router-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=t,r=$(n).text(),l=o;message.showMessage("notice","Deleting "+r+".");var d=document.getElementById(i+"-actions-cell"),c=d.innerHTML;disableLinks(!0),disableActions("delete-router",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"routers",!1);var p=i+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn(),$.getJSON("/delete_router/"+PROJECT_ID+"/"+i+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message),l.fadeOut().remove();var t=$("#router_list tr").length;2>t&&$(s).append(a).fadeIn(),routers.items[i].network&&(addToSelect(routers.items[i].network,privateNetworks.items[routers.items[i].network].name,$("#priv_net"),privNetRoutOpts),privateNetworks.items[routers.items[i].network].router="None"),routers.removeItem(i)}}).fail(function(){message.showMessage("error","Server Fault"),$(d).empty().fadeOut(),$(d).append(c).fadeIn()}).always(function(){disableProgressbar(e,"routers",!0),disableLinks(!1),disableActions("delete-router",!1)}),$(this).dialog("close")}},close:function(){}})})}),$(function(){var e=$("#secGroup_progressbar"),s=$("#secGroup_list"),a='<tr id="#secGroup_placeholder"><td><p><i>You have no keys defined</i></p></td><td></td><td></td></tr>';$(function(){var a=$("#ports"),t=$("#groupname"),n=$("#groupdesc"),o=$([]).add(a).add(t).add(n);$("#create-security-group").click(function(e){e.preventDefault(),$("#sec-group-dialog-form").dialog("open")}),$("#sec-group-dialog-form").dialog({autoOpen:!1,height:410,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create a security group":function(){clearUiValidation(o);var i=checkLength(t,"Group Name",3,16)&&checkLength(n,"Group Description",6,80);if(i){var r=a.val(),l=$("input[name=transport]:checked").val(),d=t.val(),c=n.val();""==r&&(r="443,80,22"),void 0==l&&(l="tcp"),message.showMessage("notice","Creating new Key "+d),setVisible("#create-security-group",!1),disableLinks(!0),$(e).progressbar({value:!1}),setVisible(e,!0),$.getJSON("/create_security_group/"+d+"/"+c+"/"+r+"/"+l+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a="";a+='<tr id="'+e.sec_group_id+'"><td id="'+e.sec_group_id+'-name-cell"><a href="/security_group/'+e.sec_group_id+"/"+PROJECT_ID+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.sec_group_id+'-name-text">'+e.sec_group_name+'</span></td><td id="'+e.sec_group_id+'-username-cell"><span id="'+e.sec_group_id+'-username-text">'+e.username+'</span></td><td id="'+e.sec_group_id+'-actions-cell"><a href="#" class="delete-secGroup">delete</a></tr>';var t=$("#secGroup_list tr").length;2>=t&&$("#secGroup_placeholder").remove().fadeOut(),s.append(a).fadeIn(),addToSelect(e.sec_group_name,e.sec_group_name,$("#sec_group_name"),secGroupInstOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){setVisible(e,!1),setVisible("#create-security-group",!0),disableLinks(!1),resetUiValidation(o),$("input#tcp").prop("checked",!0),a.val("443,80,22")}),$(this).dialog("close")}else;}},close:function(){resetUiValidation(o)}})}),$(function(){var s,t="",n="";$(document).on("click",".delete-secGroup",function(e){e.preventDefault(),s=$(this).parent().parent(),t=$(s).attr("id"),n=document.getElementById(t+"-name-text"),$("div#sec-group-delete-confirm-form > p > span.secGroup-name").empty().append($(n).text()),$("#sec-group-delete-confirm-form").dialog("open")}),$("#sec-group-delete-confirm-form").dialog({autoOpen:!1,height:125,width:245,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var o=t,i=$(n).text(),r=document.getElementById(o+"-actions-cell"),l=r.innerHTML;message.showMessage("notice","Deleting "+i+"."),disableLinks(!0),disableActions("delete-secGroup",!0),$(e).progressbar({value:!1}),setVisible(e,!0);var d=o+"-loader",c='<div class="ajax-loader" id="'+d+'"></div>';$(r).empty().fadeOut(),$(r).append(c).fadeIn(),$.getJSON("/delete_sec_group/"+o+"/"+PROJECT_ID+"/").done(function(e){"error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(l).fadeIn()),"success"==e.status&&(message.showMessage("success",e.message),$(s).fadeOut().remove());var t=$("#secGroup_list tr").length;2>t&&$("#secGroup_list").append(a).fadeIn(),removeFromSelect(i,$("#sec_group_name"),secGroupInstOpts)}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(l).fadeIn()}).always(function(){disableLinks(!1),disableActions("delete-secGroup",!1),setVisible(e,!1)}),$(this).dialog("close")}},close:function(){}})})}),$(function(){var e=$("#snapshot_progressbar"),s=$("#snapshot_list"),a='<tr id="snapshot_placeholder"><td><p><i>This project has no snapshots</i></p></td><td></td><td></td></tr>';$(document).ready(function(){$("#volume_placeholder").length&&setVisible("#create-snapshot",!1)}),$(function(){var a=$("#snap_name"),t=$("#snap_volume"),n=$("#snap_desc"),o=$([]).add(a).add(t).add(n);$("#create-snapshot").click(function(e){e.preventDefault(),$("#snapshot-dialog-form").dialog("open")}),$("#snapshot-dialog-form").dialog({autoOpen:!1,height:350,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Snapshot":function(){clearUiValidation(o);var i=checkLength(a,"Snapshot Name",3,16)&&checkLength(n,"Snapshot Name",1,80);if(i){var r=a.val(),l=t.val(),d=n.val();message.showMessage("notice","Creating new snapshot "+r),disableLinks(!0),setVisible("#create-snapshot",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"snapshots",!1),$.getJSON("/create_snapshot/"+PROJECT_ID+"/"+r+"/"+l+"/"+d+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a='<tr id="'+e.snapshot_id+'"><td id="'+e.snapshot_id+'-name-cell"><a href="/snapshot/'+e.snapshot_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.snapshot_id+'-name-text">'+e.snapshot_name+'</span></a></td><td id="'+e.snapshot_id+'-volume-cell"><span id="'+e.snapshot_id+'-volume-text">'+volumes.getItem(e.volume_id).name+'</span></td><td id="'+e.snapshot_id+'-actions-cell"><a href="#" class="delete-snapshot">delete</a><span> | </span><a href="#" class="create-volume-from-snapshot">create volume</a></td></tr>';s.append(a).fadeIn();var t=$("#snapshot_list tr").length;t>2&&$("#snapshot_placeholder").remove().fadeOut(),snapshots.setItem(e.snapshot_id,{id:e.snapshot_id,name:e.snapshot_name,volumeId:e.volume_id,volumeName:volumes.getItem(e.volume_id).name,value:e.snapshot_id,option:e.snapshot_name}),refreshSelect("#revert_snapshot_name",snapshots)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"snapshots",!0),setVisible("#create-snapshot",!0),disableLinks(!1),resetUiValidation(o)}),$(this).dialog("close")}}},close:function(){resetUiValidation(o)}})}),$(function(){var t,n,o;$(document).on("click",".delete-snapshot",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=document.getElementById(t+"-name-text"),$("div#snapshot-delete-confirm-form > p > span.snapshot-name").empty().append($(n).text()),$("#snapshot-delete-confirm-form").dialog("open")}),$("#snapshot-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=t,r=$(n).text(),l=o;message.showMessage("notice","Deleting "+r+".");var d=document.getElementById(i+"-actions-cell"),c=d.innerHTML;disableLinks(!0),disableActions("delete-snapshot",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"snapshots",!1);var p=i+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn(),$.getJSON("/delete_snapshot/"+PROJECT_ID+"/"+i+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message),l.fadeOut().remove();var t=$("#snapshot_list tr").length;2>t&&$(s).append(a).fadeIn(),snapshots.removeItem(i)}}).fail(function(){message.showMessage("error","Server Fault"),$(d).empty().fadeOut(),$(d).append(c).fadeIn()}).always(function(){disableProgressbar(e,"snapshots",!0),disableLinks(!1),disableActions("delete-snapshot",!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t,n=$("#vol_from_snap_name"),o=$("#vol_from_snap_size"),i=$("#vol_from_snap_desc"),r=$([]).add(n).add(o).add(i);$(document).on("click",".create-volume-from-snapshot",function(e){e.preventDefault(),t=$(this).parent().parent(),s=$(t).attr("id"),a=snapshots.items[s].volumeName,$("div#create-volume-from-snapshot-form > p > span.vol-from-snap-name").empty().append($(a).text()),$("#create-volume-from-snapshot-form").dialog("open")}),$("#create-volume-from-snapshot-form").dialog({autoOpen:!1,height:335,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Volume":function(){clearUiValidation(r);var t=checkLength(n,"Volume Name",0,16)&&checkDuplicateName(n,volumes)&&checkSize(o,"Volume Size must be greater than 0.",1,0)&&checkLength(i,"Description",0,16);if(t){var l=n.val(),d=o.val(),c=i.val(),p=s,u=$(a).text();""==l&&(l="none"),""==c&&(c="none"),message.showMessage("notice","Cloning "+u+".");var m=document.getElementById(p+"-actions-cell"),g=m.innerHTML;disableLinks(!0),disableActions("create-volume-from-snapshot",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"snapshots",!1);var f=p+"-loader",v='<div class="ajax-loader" id="'+f+'"></div>';$(m).empty().fadeOut(),$(m).append(v).fadeIn(),$.getJSON("/create_vol_from_snapshot/"+PROJECT_ID+"/"+p+"/"+d+"/"+l+"/"+c+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success","Volume "+l+" cloned from "+u+".");var s='<tr id="'+e.volume_id+'" class="'+e.volume_size+'"><td id="'+e.volume_id+'-name-cell"><a href="/projects/'+PROJECT_ID+"/volumes/"+e.volume_id+'/view/" class="disable-link"><span id="'+e.volume_id+'-name-text">'+e.volume_name+'</span></a></td><td id="'+e.volume_id+'-attached-cell"><span id="'+e.volume_id+'-attached-placeholder">No Attached Instances</span></td><td id="'+e.volume_id+'-actions-cell"><a href="#" class="attach-volume">attach</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a></td></tr>',a=$("#volume_list tr").length;2>=a&&($("#volume_placeholder").remove().fadeOut(),setVisible("#create-snapshot",!0)),$("#volume_list").append(s).fadeIn(),volumes.setItem(e.volume_id,{size:e.volume_size,name:e.volume_name}),snapshotVolumes.setItem(e.volume_id,{value:e.volume_id,option:e.volume_name}),refreshSelect($("#snap_volume"),snapshotVolumes),updateUsedStorage(),updateStorageBar()}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){$(m).empty().fadeOut(),$(m).append(g).fadeIn(),disableProgressbar(e,"snapshots",!0),disableLinks(!1),disableActions("create-volume-from-snapshot",!1),resetUiValidation(r)}),$(this).dialog("close")}}},close:function(){}})})}),$(function(){var e=$("#users_progressbar"),s=$("#users_list"),a='<tr id="users_placeholder"><td><p><i>This project has no images</i></p></td><td></td></tr>';$(function(){var a=$("#username"),t=$("#email"),n=$("#password"),o=$("#confirm"),i=$("#role"),r=$([]).add(a).add(t).add(n).add(o).add(i);$("#create-user").click(function(e){e.preventDefault(),$("#user-dialog-form").dialog("open")}),$("#user-dialog-form").dialog({autoOpen:!1,height:475,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Account":function(){clearUiValidation(r);var l=checkLength(a,"username",3,16)&&checkUsername(a)&&checkDuplicateName(a,users)&&checkLength(t,"email",6,80)&&checkEmail(t)&&checkLength(n,"password",5,16)&&checkPassword(n)&&checkPasswordMatch(n,o);if(l){var d=a.val(),c=n.val(),p=t.val(),u=i.val();message.showMessage("notice","Creating new user "+a.val()),setVisible("#create-user",!1),setVisible("#add-existing-user",!1),disableLinks(!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1),$.getJSON("/create_user/"+d+"/"+c+"/"+u+"/"+p+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a="";a+='<tr id="'+e.user_id+'"><td id="'+e.user_id+'-name-cell"><a href="/projects/'+PROJECT+"/"+PROJECT_ID+"/user/"+e.username+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.user_id+'-name-text">'+d+'</span></a><a href="mailto:'+p+'"><span id="'+e.user_id+'-email-text"> ('+p+')</span></a><span id="'+e.user_id+'-role-text"> '+u+'</span></td><td id="'+e.user_id+'-actions-cell"><a href="#" class="disable-user">disable</a><span class="user-actions-pipe"> | </span><a href="#" class="remove-user">remove</a><span class="user-actions-pipe"> | </span><a href="#" class="delete-user">delete</a></td></tr>';var t=$("#users_list tr").length;2>=t&&$("#users_placeholder").remove().fadeOut(),s.append(a).fadeIn(),users.setItem(e.username,{id:e.user_id,enabled:"TRUE",username:e.username,email:p,role:u,removed:"FALSE"})}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"users",!0),setVisible("#create-user",!0),disableLinks(!1),resetUiValidation(r),checkAddUser()}),$(this).dialog("close")}}},close:function(){resetUiValidation(r)}})}),$(function(){var t,n,o;$(document).on("click",".delete-user",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=document.getElementById(t+"-name-text"),$("div#user-delete-confirm-form > p > span.user-name").empty().append($(n).text()),$("#user-delete-confirm-form").dialog("open")}),$("#user-delete-confirm-form").dialog({autoOpen:!1,height:125,width:200,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=o,r=t,l=$(n).text();message.showMessage("notice","Deleting "+l+".");var d=document.getElementById(r+"-actions-cell"),c=d.innerHTML;disableLinks(!0),disableActions("delete-user",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1);var p=r+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn(),$.getJSON("/delete_user/"+l+"/"+r+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message),i.fadeOut().remove(),users.removeItem(l);var t=$("#users_list tr").length;2>t&&$(s).append(a).fadeIn()}}).fail(function(){message.showMessage("error","Server Fault"),$(d).empty().fadeOut(),$(d).append(c).fadeIn()}).always(function(){disableProgressbar(e,"users",!0),disableActions("delete-user",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var a=$("#username"),t=$("#role");$("#add-existing-user").click(function(e){e.preventDefault(),$("#user-add-existing-dialog-form").dialog("open")}),$("#user-add-existing-dialog-form").dialog({autoOpen:!1,height:300,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Add Existing User":function(){var n=a.val(),o=t.val();message.showMessage("notice","Adding existing user "+n+"."),setVisible("#create-user",!1),setVisible("#add-existing-user",!1),disableLinks(!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1),$.getJSON("/add_existing_user/"+n+"/"+o+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message),users.items[n].removed="FALSE",users.items[n].role=o;var a='<tr id="'+users.items[n].id+'" class="';a+="FALSE"==users.items[n].enabled?'user-disabled">':'">',a+='<td id="'+users.items[n].id+'-name-cell"><a href="/projects/'+PROJECT+"/"+PROJECT_ID+"/user/"+users.items[n].username+'/view/" class="disable-link"><span id="'+users.items[n].id+'-name-text">'+users.items[n].username+'</span></a><a href="mailto:'+users.items[n].email+'"><span id="'+users.items[n].id+'-email-text"> ('+users.items[n].email+') </span></a><span id="'+users.items[n].id+'-role-text" class="right">'+users.items[n].role+'</span></td><td id="'+users.items[n].id+'-actions-cell">',a+="TRUE"==users.items[n].enabled?'<a href="#" class="disable-user">disable</a>':'<a href="#" class="enable-user">enable</a>',a+='<span class="user-actions-pipe"> | </span><a href="#" class="remove-user">remove</a><span class="user-actions-pipe"> | </span><a href="#" class="delete-user"> delete</a></td></tr>',s.append(a).fadeIn();var t=$("#users_list tr").length;t>=2&&$("#users_placeholder").remove().fadeOut(),removeFromSelect(n,$("select#username"),orphanedUserOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"users",!0),setVisible("#create-user",!0),disableLinks(!1),checkAddUser()}),$(this).dialog("close")}},close:function(){}})}),$(function(){var t,n,o;$(document).on("click",".remove-user",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=document.getElementById(t+"-name-text"),$("div#user-remove-confirm-form > p > span.user-name").empty().append($(n).text()),$("#user-remove-confirm-form").dialog("open")}),$("#user-remove-confirm-form").dialog({autoOpen:!1,height:125,width:200,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=o,r=t,l=$(n).text();message.showMessage("notice","Removing "+l+".");var d=document.getElementById(r+"-actions-cell"),c=d.innerHTML;disableLinks(!0),disableActions("remove-user",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1);var p=r+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn(),$.getJSON("/remove_user_from_project/"+r+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message),i.fadeOut().remove(),users.items[l].removed="TRUE",addToSelect(l,l,$("select#username"),orphanedUserOpts);var t=$("#users_list tr").length;2>t&&s.append(a).fadeIn()}}).fail(function(){message.showMessage("error","Server Fault"),$(d).empty().fadeOut(),$(d).append(c).fadeIn()}).always(function(){disableProgressbar(e,"users",!0),disableActions("remove-user",!1),disableLinks(!1),checkAddUser()}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t;$(document).on("click",".enable-user",function(e){e.preventDefault(),t=$(this).parent().parent(),s=$(t).attr("id"),a=document.getElementById(s+"-name-text"),$("div#user-enable-confirm-form > p > span.user-name").empty().append($(a).text()),$("#user-enable-confirm-form").dialog("open")}),$("#user-enable-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=t,o=s,i=$(a).text();message.showMessage("notice","Enabling "+i+".");var r=document.getElementById(o+"-actions-cell"),l=r.innerHTML;disableLinks(!0),disableActions("enable-user",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1);var d=o+"-loader",c='<div class="ajax-loader" id="'+d+'"></div>';$(r).empty().fadeOut(),$(r).append(c).fadeIn(),$.getJSON("/toggle_user/"+i+"/enable/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(l).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s='<a href="#" class="disable-user">disable</a><span class="user-actions-pipe"> | </span><a href="#" class="remove-user">remove</a><span class="user-actions-pipe"> | </span><a href="#" class="delete-user"> delete</a>';$(r).empty().fadeOut(),$(r).append(s).fadeIn(),n.removeClass("user-disabled")}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(l).fadeIn()}).always(function(){disableProgressbar(e,"users",!0),disableActions("enable-user",!1),disableLinks(!1)}),$(this).dialog("close")},close:function(){}}})}),$(function(){var s,a,t;$(document).on("click",".disable-user",function(e){e.preventDefault(),t=$(this).parent().parent(),s=$(t).attr("id"),a=document.getElementById(s+"-name-text"),$("div#user-disable-confirm-form > p > span.user-name").empty().append($(a).text()),$("#user-disable-confirm-form").dialog("open")}),$("#user-disable-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=t,o=s,i=$(a).text();message.showMessage("notice","Disabling "+i+".");var r=document.getElementById(o+"-actions-cell"),l=r.innerHTML;disableLinks(!0),disableActions("disable-user",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1);var d=o+"-loader",c='<div class="ajax-loader" id="'+d+'"></div>';$(r).empty().fadeOut(),$(r).append(c).fadeIn(),$.getJSON("/toggle_user/"+i+"/disable/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(l).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s='<a href="#" class="enable-user">enable</a><span class="user-actions-pipe"> | </span><a href="#" class="remove-user">remove</a><span class="user-actions-pipe"> | </span><a href="#" class="delete-user"> delete</a>';$(r).empty().fadeOut(),$(r).append(s).fadeIn(),n.addClass("user-disabled")}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(l).fadeIn()}).always(function(){disableProgressbar(e,"users",!0),disableActions("disable-user",!1),disableLinks(!1)}),$(this).dialog("close")},close:function(){}}})})}),$(function(){var e=$("#vol_progressbar"),s=$("#volume_list"),a='<tr id="volume_placeholder"><td><p><i>This project has no volumes</i></p></td><td></td><td></td>/tr>';$(function(){var a=$("#volume_name"),t=$("#volume_size"),n=$("#description"),o=$("#volume_type"),i=$([]).add(a).add(t).add(n).add(o);$(document).on("click","#create-volume",function(e){e.preventDefault(),$("#volume-dialog-form").dialog("open")}),$("#volume-dialog-form").dialog({autoOpen:!1,height:445,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Volume":function(){clearUiValidation(i);var r=checkLength(a,"Volume Name",3,16)&&checkDuplicateName(a,volumes)&&checkSize(t,"Volume Size must be greater than 0.",1,0)&&checkStorage(t)&&checkLength(n,"Description",1,16);if(r){var l=a.val(),d=t.val(),c=n.val(),p=o.val();""==c&&(c="none"),message.showMessage("notice","Creating new volume "+a.val()),disableLinks(!0),setVisible("#create-volume",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1),$.getJSON("/create_volume/"+l+"/"+d+"/"+c+"/"+p+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a='<tr id="'+e.volume_id+'" class="'+e.volume_size+'"><td id="'+e.volume_id+'-name-cell"><a href="/projects/'+PROJECT_ID+"/volumes/"+e.volume_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.volume_id+'-name-text">'+e.volume_name+'</span></a></td><td id="'+e.volume_id+'-attached-cell"><span id="'+e.volume_id+'-attached-placeholder">No Attached Instance</span></td><td id="'+e.volume_id+'-actions-cell"><a href="#" class="attach-volume">attach</a><span class="volume-actions-pipe"> | </span><a href="#" class="clone-volume">clone</a><span class="volume-actions-pipe"> | </span><a href="#" class="revert-volume">revert</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a></td></tr>',t=$("#volume_list tr").length;2>=t&&($("#volume_placeholder").remove().fadeOut(),setVisible("#create-snapshot",!0)),s.append(a).fadeIn(),volumes.setItem(e.volume_id,{size:e.volume_size,name:e.volume_name}),snapshotVolumes.setItem(e.volume_id,{value:e.volume_id,option:e.volume_name}),refreshSelect($("#snap_volume"),snapshotVolumes),updateUsedStorage(),updateStorageBar()}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"volumes",!0),setVisible("#create-volume",!0),disableLinks(!1),resetUiValidation(i)}),$(this).dialog("close")}}},close:function(){resetUiValidation(i)}})}),$(function(){var t,n,o;$(document).on("click",".delete-volume",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=document.getElementById(t+"-name-text"),$("div#volume-delete-confirm-form > p > span.volume-name").empty().append($(n).text());var s=0;for(var a in snapshots.items){var i=snapshots.getItem(a).volumeId;i==t&&s++}s>0?message.showMessage("error","Cannot delete this volume because it has "+s+" dependent snapshots."):$("#volume-delete-confirm-form").dialog("open")}),$("#volume-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=o,r=t,l=$(n).text();message.showMessage("notice","Deleting "+l+".");var d=document.getElementById(r+"-actions-cell"),c=d.innerHTML;disableLinks(!0),disableActions("delete-volume",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1);var p=r+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn(),$.getJSON("/delete_volume/"+r+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message),i.fadeOut().remove(),volumes.removeItem(r),snapshotVolumes.removeItem(r),refreshSelect($("#snap_volume"),snapshotVolumes),updateUsedStorage(),updateStorageBar();var t=$("#volume_list tr").length;2>t&&($(s).append(a).fadeIn(),setVisible("#create-snapshot",!1))}}).fail(function(){message.showMessage("error","Server Fault"),$(d).empty().fadeOut(),$(d).append(c).fadeIn()}).always(function(){disableProgressbar(e,"volumes",!0),disableLinks(!1),disableActions("delete-volume",!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var a,t,n,o=$("#clone_volume_name"),i=$("#description"),r=$([]).add(o).add(i);$(document).on("click",".clone-volume",function(e){e.preventDefault(),n=$(this).parent().parent(),a=$(n).attr("id"),t=document.getElementById(a+"-name-text"),$("div#volume-clone-form > p > span.volume-name").empty().append($(t).text()),$("#volume-clone-form").dialog("open")}),$("#volume-clone-form").dialog({autoOpen:!1,height:250,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=a,l=o.val(),d=i.val();""==l&&(l="none"),""==d&&(d="none"),message.showMessage("notice","Cloning "+$(t).text()+".");var c=document.getElementById(n+"-actions-cell"),p=c.innerHTML;disableLinks(!0),disableActions("clone-volume",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1);var u=n+"-loader",m='<div class="ajax-loader" id="'+u+'"></div>';$(c).empty().fadeOut(),$(c).append(m).fadeIn(),$.getJSON("/create_vol_clone/"+PROJECT_ID+"/"+n+"/"+l+"/"+d+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success","Volume "+l+" cloned from volume "+$(t).text()+".");var a='<tr id="'+e.volume_id+'"><td id="'+e.volume_id+'-name-cell"><a href="/projects/'+PROJECT_ID+"/volumes/"+e.volume_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.volume_id+'-name-text">'+e.volume_name+'</span></a></td><td id="'+e.volume_id+'-attached-cell"><span id="'+e.volume_id+'-attached-placeholder">No Attached Instance</span></td><td id="'+e.volume_id+'-actions-cell"><a href="#" class="attach-volume">attach</a><span class="volume-actions-pipe"> | </span><a href="#" class="clone-volume">clone</a><span class="volume-actions-pipe"> | </span><a href="#" class="revert-volume">revert</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a></td></tr>',n=$("#volume_list tr").length;2>=n&&($("#volume_placeholder").remove().fadeOut(),setVisible("#create-snapshot",!0)),s.append(a).fadeIn(),volumes.setItem(e.volume_id,{size:e.volume_size,name:e.volume_name}),snapshotVolumes.setItem(e.volume_id,{value:e.volume_id,option:e.volume_name}),refreshSelect($("#snap_volume"),snapshotVolumes),updateUsedStorage(),updateStorageBar()}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){$(c).empty().fadeOut(),$(c).append(p).fadeIn(),disableProgressbar(e,"volumes",!0),disableLinks(!1),disableActions("clone-volume",!1),resetUiValidation(r)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t;$(document).on("click",".attach-volume",function(e){e.preventDefault(),t=$(this).parent().parent(),s=$(t).attr("id"),a=document.getElementById(s+"-name-text"),$("div#volume-attach-dialog-form > p > span.volume-name").empty().append($(a).text()),$("#volume-attach-dialog-form").dialog("open")}),$("#volume-attach-dialog-form").dialog({autoOpen:!1,height:225,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Attach Volume":function(){var n=$("#instance"),o=t,i=s,r=$(a).text(),l=instanceOpts.items[n.val()].value,d=instanceOpts.items[l].option;message.showMessage("notice","Attaching "+r+" to "+d+".");var c=document.getElementById(i+"-actions-cell"),p=c.innerHTML;disableLinks(!0),disableActions("attach-volume",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1);var u=i+"-loader",m='<div class="ajax-loader" id="'+u+'"></div>';$(c).empty().fadeOut(),$(c).append(m).fadeIn(),$.getJSON("/attach_volume/"+PROJECT_ID+"/"+l+"/"+i+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(c).empty().fadeOut(),$(c).append(p).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(i+"-attached-cell");$(c).empty().fadeOut(),$(s).empty().fadeOut();var a='<a href="#" class="detach-volume">detach</a><span class="volume-actions-pipe"> | </span><a href="#" class="clone-volume">clone</a><span class="volume-actions-pipe"> | </span><a href="#" class="revert-volume">revert</a>';$(c).append(a).fadeIn(),$(s).append(d).fadeIn(),o.addClass("volume-attached")}}).fail(function(){message.showMessage("error","Server Fault"),$(c).empty().fadeOut(),$(c).append(p).fadeIn()}).always(function(){disableProgressbar(e,"volumes",!0),disableLinks(!1),disableActions("attach-volume",!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,t,n=$("#instance");$(document).on("click",".detach-volume",function(e){e.preventDefault(),t=$(this).parent().parent(),s=t.attr("id"),a=document.getElementById(s+"-name-text"),$("div#volume-detach-confirm-form > p > span.volume-name").empty().append($(a).text()),$("#volume-detach-confirm-form").dialog("open")}),$("#volume-detach-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Detach Volume":function(){var o=t,i=s,r=$(a).text(),l=n.val(),d=instanceOpts.items[l].option;message.showMessage("notice","Detaching "+r+" from "+d+".");var c=document.getElementById(i+"-actions-cell"),p=c.innerHTML;disableLinks(!0),disableActions("detach-volume",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1);var u=i+"-loader",m='<div class="ajax-loader" id="'+u+'"></div>';$(c).empty().fadeOut(),$(c).append(m).fadeIn(),$.getJSON("/detach_volume/"+PROJECT_ID+"/"+i+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(c).empty().fadeOut(),$(c).append(p).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(i+"-attached-cell");$(c).empty().fadeOut(),$(s).empty().fadeOut();var a='<a href="#" class="attach-volume">attach</a><span class="volume-actions-pipe"> | </span><span class="volume-actions-pipe"> | </span><a href="#" class="clone-volume">clone</a><span class="volume-actions-pipe"> | </span><a href="#" class="revert-volume">revert</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a>';$(c).append(a).fadeIn(),$(s).append("No Attached Instance").fadeIn(),o.removeClass("volume-attached")}}).fail(function(){message.showMessage("error","Server Fault"),$(c).empty().fadeOut(),$(c).append(p).fadeIn()}).always(function(){disableProgressbar(e,"volumes",!0),disableLinks(!1),disableActions("detach-volume",!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var a,t,n,o,i=$("#revert_snapshot_name"),r=$("#revert_volume_name"),l=$([]).add(i);$(document).on("click",".revert-volume",function(e){e.preventDefault(),n=$(this).parent().parent(),o=!!n.hasClass("volume-attached"),a=$(n).attr("id"),t=document.getElementById(a+"-name-text"),$("div#volume-revert-form > p > span.volume-name").empty().append($(t).text()),updateRevertVolumeSnapshots(a),$("#volume-revert-form").dialog("open")}),$("#volume-revert-form").dialog({autoOpen:!1,height:250,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){clearUiValidation(l);var n=checkLength(r,"Volume Name",3,16)&&checkDuplicateName(r,volumes);if(n){var d=a,c=r.val(),p=i.val();message.showMessage("notice","Reverting "+$(t).text()+".");var u=document.getElementById(d+"-actions-cell"),m=u.innerHTML;disableLinks(!0),disableActions("revert-volume",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1);var g=d+"-loader",f='<div class="ajax-loader" id="'+g+'"></div>';$(u).empty().fadeOut(),$(u).append(f).fadeIn(),$.getJSON("/revert_volume_snapshot/"+PROJECT_ID+"/"+d+"/"+c+"/"+p+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a='<tr id="'+e.volume_info.volume_id+'" class="';o&&(a+="volume-attached"),a+='"><td id="'+e.volume_info.volume_id+'-name-cell"><a href="/projects/'+PROJECT_ID+"/volumes/"+e.volume_info.volume_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.volume_info.volume_id+'-name-text">'+e.volume_info.volume_name+'</span></a></td><td id="'+e.volume_info.volume_id+'-attached-cell"><span id="'+e.volume_info.volume_id+'-attached-placeholder">',a+=o?instances.items[e.attach_info.instance_id].name:"No Attached Instances",a+='</span></td><td id="'+e.volume_info.volume_id+'-actions-cell">',a+=o?'<a href="#" class="detach-volume">detach</a>':'<a href="#" class="attach-volume">attach</a>',a+='<span class="volume-actions-pipe"> | </span><a href="#" class="clone-volume">clone</a><span class="volume-actions-pipe"> | </span><a href="#" class="revert-volume">revert</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a></td></tr>';var t=$("#volume_list tr").length;2>=t&&($("#volume_placeholder").remove().fadeOut(),setVisible("#create-snapshot",!0)),s.append(a).fadeIn(),volumes.setItem(e.volume_id,{size:e.volume_size,name:e.volume_name}),snapshotVolumes.setItem(e.volume_id,{value:e.volume_id,option:e.volume_name}),refreshSelect($("#snap_volume"),snapshotVolumes),updateUsedStorage(),updateStorageBar()}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){$(u).empty().fadeOut(),$(u).append(m).fadeIn(),disableProgressbar(e,"volumes",!0),disableLinks(!1),disableActions("revert-volume",!1),resetUiValidation(l)}),$(this).dialog("close")}}},close:function(){}})})});