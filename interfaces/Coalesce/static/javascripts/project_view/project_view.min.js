/* fip */ $(function(){var e=$("#fip_progressbar"),s=$("#fip_list"),a='<tr id="fip_placeholder"><td><p><i>This project has no floating IPs</i></p></td><td></td><td></td></tr>';$("#allocate_ip").click(function(a){a.preventDefault(),message.showMessage("notice","Allocating IP."),disableLinks(!0),setVisible("#allocate_ip",!1),setVisible("#assign_ip",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"fips",!1),$.getJSON("/allocate_floating_ip/"+PROJECT_ID+"/"+extNet+"/").done(function(e){if("error"==e.status&&message.showMessage("error","No available IPs.  If you just deallocated an IP, wait a few minutes and try again."),"success"==e.status){message.showMessage("success","Successfully allocated "+e.ip_info.floating_ip+".");var a='<tr id="'+e.ip_info.floating_ip_id+'"><td id="'+e.ip_info.floating_ip_id+'-ip-cell"><a href="/floating_ip/'+e.ip_info.floating_ip_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.ip_info.floating_ip_id+'-ip-address">'+e.ip_info.floating_ip+'</span></a></td><td id="'+e.ip_info.floating_ip_id+'-instance-cell"><span id="'+e.ip_info.floating_ip_id+'-instance-name">None</span></td><td id="'+e.ip_info.floating_ip_id+'-actions-cell"><a href="#" " class="deallocate_ip">deallocate</a></td></tr>',i=$("#fip_list tr").length;2>=i&&$("#fip_placeholder").remove().fadeOut(),$(s).append(a).fadeIn(),addToSelect(e.ip_info.floating_ip_id,e.ip_info.floating_ip,$("#assign_floating_ip"),assignableFips)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){checkAssignFip(),disableProgressbar(e,"fips",!0),setVisible("#allocate_ip",!0),disableLinks(!1)})}),$(function(){var i,n,t;$(document).on("click",".deallocate_ip",function(e){e.preventDefault(),t=$(this).parent().parent(),i=$(t).attr("id"),n=$(document.getElementById(i+"-ip-address")).text(),$("div#fip-deallocate-confirm-form > p > span.ip-address").empty().append(n),$("#fip-deallocate-confirm-form").dialog("open")}),$("#fip-deallocate-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var o=i,l=n,d=t;message.showMessage("notice","Deallocating "+l+".");var p=document.getElementById(o+"-actions-cell"),r='<a class="deallocate_ip" href="#">deallocate</a></td>';disableLinks(!0),disableActions("deallocate_ip",!0),setVisible("#allocate_ip",!1),setVisible("#assign_ip",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"fips",!1);var c=o+"-loader",g='<div class="ajax-loader" id="'+c+'"></div>';$(p).empty().fadeOut(),$(p).append(g).fadeIn(),$.getJSON("/deallocate_floating_ip/"+PROJECT_ID+"/"+l+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(p).empty().fadeOut(),$(p).append(r).fadeIn()),"success"==e.status){message.showMessage("success",e.message),$(d).fadeOut().remove();var i=$("#fip_list tr").length;2>i&&$(s).append(a).fadeIn(),removeFromSelect(o,$("#assign_floating_ip"),assignableFips)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){checkAssignFip(),disableProgressbar(e,"fips",!0),setVisible("#allocate_ip",!0),disableActions("deallocate_ip",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s=$("#assign_floating_ip"),a=$("#assign_instance");$("#assign_ip").click(function(e){e.preventDefault(),$("#fip-assign-dialog-form").dialog("open")}),$("#fip-assign-dialog-form").dialog({autoOpen:!1,height:265,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Assign:function(){var i=s.val(),n=$(document.getElementById(i+"-ip-address")).text(),t=a.val(),o=document.getElementById(i);disableLinks(!0),setVisible("#allocate_ip",!1),setVisible("#assign_ip",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"fips",!1),$.getJSON("/assign_floating_ip/"+n+"/"+t+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var i=document.getElementById(e.floating_ip_id+"-instance-cell"),n=document.getElementById(e.floating_ip_id+"-actions-cell"),l='<span id="'+e.floating_ip_id+'-instance-name">'+e.instance_name+"</span>",d='<a href="#" id="'+e.floating_ip_id+'" class="unassign_ip">unassign</a>';$(i).empty().fadeOut(),$(n).empty().fadeOut(),$(i).append(l).fadeIn(),$(n).append(d).fadeIn(),removeFromSelect(e.floating_ip_id,s,assignableFips),removeFromSelect(t,a,assignableInstances),$(o).addClass("fip-assigned")}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){checkAssignFip(),disableProgressbar(e,"fips",!0),setVisible("#allocate_ip",!0),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,i,n,t;$(document).on("click",".unassign_ip",function(e){e.preventDefault(),s=$(this).parent().parent(),i=$(s).attr("id"),a=$(document.getElementById(i+"-ip-address")).text(),n=$(document.getElementById(i+"-instance-name")).text(),t=$("a").filter(function(){return $(this).text()==n}),t=$(t).parent().parent().attr("id"),$("div#fip-unassign-confirm-form > p > span.ip-address").empty().append(a),$("#fip-unassign-confirm-form").dialog("open")}),$("#fip-unassign-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:window},buttons:{Confirm:function(){var o=a,l=i,d=t,p=n;message.showMessage("notice","Unassigning "+o+".");var r=document.getElementById(l+"-actions-cell"),c=r.innerHTML;disableLinks(!0),disableActions("unassign_ip",!0),setVisible("#assign_ip",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"fips",!1);var g=l+"-loader",f='<div class="ajax-loader" id="'+g+'"></div>';$(r).empty().fadeOut(),$(r).append(f).fadeIn(),$.getJSON("/unassign_floating_ip/"+l+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(c)),"success"==e.status){message.showMessage("success",e.message);var a=document.getElementById(e.floating_ip_id+"-instance-cell"),i='<span id="'+e.floating_ip_id+'-instance-name">None</span>',n='<a href="#" class="deallocate_ip">deallocate</a>';$(a).empty().fadeOut(),$(r).empty().fadeOut(),$(a).append(i).fadeIn(),$(r).append(n).fadeIn(),addToSelect(e.floating_ip_id,e.floating_ip,$("#assign_floating_ip"),assignableFips),addToSelect(d,p,$("#assign_instance"),assignableInstances),$(s).removeClass("fip-assigned")}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(c)}).always(function(){checkAssignFip(),disableProgressbar(e,"fips",!0),setVisible("#assign_ip",!0),disableActions("unassign_ip",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})})});
/* image */ $(function(){function e(e){var a=$("#image-import-dialog-form").find("#upload_bar"),i=$("#image-import-dialog-form").find("#upload_percent");0!=s&&clearInterval(s),s=setInterval(function(){$.getJSON("/get_upload_progress/"+e,function(e){if("error"==e.status)return message.showMessage("error",e.message),clearInterval(s),void(s=0);if(-1==e.length)return t="100%",a.width(t),i.html(t),clearInterval(s),void(s=0);if(length=parseInt(e.length),length>0)var t=Math.floor(100*parseInt(e.uploaded)/length);else var t=0;t+="%",a.width(t),i.html(t)})},1e3)}var a=$("#image_progressbar"),i=$("#image_list"),t='<tr id="#image_placeholder"><td><p><i>This project has no image</i></p></td><td></td></tr>';$(function(){var a=!1,i=$("#import_img_name"),t=$("#import_img_disk"),s=$("#import_img_cont"),r=$("#import_img_type"),o=$("#import_local"),l=$("#import_remote"),n=$("#os_type"),d=$("#import_img_vis"),m="",g=$([]).add(i).add(t).add(s).add(r).add(o).add(l).add(m).add(d);$("#import-image").click(function(e){e.preventDefault(),$("#image-import-dialog-form").dialog("open")}),$("#image-import-dialog-form").dialog({autoOpen:!1,height:575,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Import Image":function(){if(!a&&(clearUiValidation(g),checkLength(i,"image_name",3,20))){var c=guid(),p=i.val();if("image_url"==r.val()){if(!checkUrl(l))return;disableFormInputs("image",["text","select","file"],!0),disableLinks(!0),e(c),m=l;var u=m.val();m=convertUrl47(m),u=u.replace(/\//g,"&47");var f=n.val();h="/import_remote/"+i.val()+"/"+s.val()+"/"+t.val()+"/"+r.val()+"/"+u+"/"+d.val()+"/"+f+"/"+c+"/",a=!0;var v=new FormData($("#image-upload-form")[0]);$.ajax({type:"POST",url:h,data:v,contentType:!1,cache:!1,processData:!1,async:!0,success:function(e){var i=JSON.parse(e);if("error"==i.status)return void message.showMessage("error",i.message);var t='<tr id="'+i.image_id+'"><td id="'+i.image_id+'-name-cell"><span id="'+i.image_id+'-name-text">'+p+'</span></td><td id="'+i.image_id+'-actions-cell"><a href="#" class="delete-image">delete</a></td></tr>';console.log("success: image_id:"+i.image_id),$("#image_list").append(t),addToSelect(p,p,$("#image_name"),imageInstOpts),message.showMessage("success",i.message),$("#image-import-dialog-form").dialog("close"),disableFormInputs("image",["text","select","file"],!1),disableLinks(!1),a=!1,resetUiValidation(g)},error:function(){message.showMessage("error","Server Fault"),$("#image-import-dialog-form").dialog("close"),disableFormInputs("image",["text","select","file"],!1),disableLinks(!1),a=!1,resetUiValidation(g)}})}else{if(!checkFile(o))return;disableUiButtons(".ui-dialog-titlebar-close",!1),disableLinks(!0),u="na";var f=n.val(),h="/import_local/"+i.val()+"/"+s.val()+"/"+t.val()+"/"+r.val()+"/"+u+"/"+d.val()+"/"+f+"/"+c+"/";a=!0;var v=new FormData($("#image-upload-form")[0]);$.ajax({type:"POST",url:h,data:v,contentType:!1,cache:!1,processData:!1,async:!0,xhr:function(){var e=$("#image-import-dialog-form").find("#upload_bar"),a=$("#image-import-dialog-form").find("#upload_percent");disableFormInputs("image",["text","select","file"],!0);var i=$.ajaxSettings.xhr();return i.upload.onprogress=function(i){if(i.lengthComputable){var t=Math.floor(100*parseInt(i.loaded)/parseInt(i.total));t+="%",e.width(t),a.html(t)}},i},success:function(e){var i=JSON.parse(e);if("error"==i.status)return void message.showMessage("error",i.message);var t='<tr id="'+i.image_id+'"><td id="'+i.image_id+'-name-cell"><span id="'+i.image_id+'-name-text">'+p+'</span></td><td id="'+i.image_id+'-actions-cell"><a href="#" class="delete-image">delete</a></td></tr>';console.log("success: image_id:"+i.image_id),$("#image_list").append(t),message.showMessage("success",i.message),$("#image-import-dialog-form").dialog("close"),disableFormInputs("image",["text","select","file"],!1),disableLinks(!1),a=!1,resetUiValidation(g)},error:function(){message.showMessage("error","Server Fault"),$("#image-import-dialog-form").dialog("close"),disableFormInputs("image",["text","select","file"],!1),disableLinks(!1),a=!1,resetUiValidation(g)}})}}}},close:function(){a||resetUiValidation(g)}})});var s=0;$(function(){var e,s,r;$(document).on("click",".delete-image",function(a){a.preventDefault(),r=$(this).parent().parent(),e=$(r).attr("id"),s=document.getElementById(e+"-name-text"),$("div#image-delete-confirm-form > p > span.image-name").empty().append($(s).text()),$("#image-delete-confirm-form").dialog("open")}),$("#image-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var o=e,l=$(s).text();message.showMessage("notice","Deleting "+l+".");var n=document.getElementById(o+"-actions-cell"),d=n.innerHTML;disableLinks(!0),disableActions("delete-image",!0),$(a).progressbar({value:!1}),disableProgressbar(a,"images",!1);var m=o+"-loader",g='<div class="ajax-loader" id="'+m+'"></div>';$(n).empty().fadeOut(),$(n).append(g).fadeIn(),$.getJSON("/delete_image/"+o+"/").done(function(e){"error"==e.status&&(message.showMessage("error",e.message),$(n).empty().fadeOut(),$(n).append(d).fadeIn()),"success"==e.status&&(message.showMessage("success",e.message),$(r).fadeOut().remove(),removeFromSelect(l,$("#image_name"),imageInstOpts));var a=$("#image_list tr").length;2>a&&$(i).append(t).fadeIn()}).fail(function(){message.showMessage("error","Server Fault"),$(n).empty().fadeOut(),$(n).append(d).fadeIn()}).always(function(){disableProgressbar(a,"images",!0),disableLinks(!1),disableActions("delete-image",!1)}),$(this).dialog("close")}},close:function(){}})})});
/* instance */ $(function(){var e=$("#instance_progressbar"),s=$("#instance_list"),a='<tr id="instance_placeholder"><td><p><i>This project has no instances</i></p></td><td></td><td></td><td></td></tr>';$(function(){var a=$("#name"),n=$("#sec_group_name"),t=$("#sec_key_name"),i=$("#network_name"),r=$("#image_name"),o=$("#flavor_name"),c=$([]).add(n).add(t).add(r).add(a).add(i);$("#create-instance").click(function(e){e.preventDefault(),$("#instance-dialog-form").dialog("open")}),$("#instance-dialog-form").dialog({autoOpen:!1,height:505,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Instance":function(){clearUiValidation(c);var d=checkLength(a,"Instance Name",3,16)&&checkDuplicateName(a,instanceOpts);if(d){var l=a.val(),p=n.val(),u=t.val(),f=i.val(),m=r.val(),v=o.val();message.showMessage("notice","Creating New Instance "+l),setVisible("#create-instance",!1),disableLinks(!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1),$.getJSON("/create_image/"+l+"/"+p+"/nova/"+v+"/"+u+"/"+m+"/"+f+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a='<tr id="'+e.server_info.server_id+'"><td id="'+e.server_info.server_id+'-name-cell"><a href="/'+PROJECT_ID+"/"+e.server_info.server_id+'/instance_view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.server_info.server_id+'-name-text">'+e.server_info.server_name+'</span></a></td><td id="'+e.server_info.server_id+'-status-cell">'+e.server_info.server_status+'</td><td id="'+e.server_info.server_id+'-os-cell">'+e.server_info.server_os+" / "+e.server_info.server_flavor+'</td><td id="'+e.server_info.server_id+'-actions-cell">';"ACTIVE"==e.server_info.server_status&&(a+='<a href="'+e.server_info.novnc_console+'" class="open-instance-console" onClick="window.open(this.href,\'_blank\',\'toolbar=no, location=no, status=no, menubar=no, titlebar = no, scrollbars=yes, resizable=yes, width=720, height=435\'); return false;">console</a><span class="instance-actions-pipe"> | </span><a href="#" class="pause-instance '+e.server_info.server_id+'-disable-action">pause</a><span class="instance-actions-pipe"> | </span><a href="#" class="suspend-instance '+e.server_info.server_id+'-disable-action">suspend</a>'),"PAUSED"==e.server_info.server_status&&(a+='<a href="#" class="unpause-instance '+e.server_info.server_id+'-disable-action">unpause</a>'),"SUSPENDED"==e.server_info.server_status&&(a+='<a href="#" class="resume-instance '+e.server_info.server_id+'-disable-action">resume</a>'),a+='<span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+e.server_info.server_id+'-disable-action">delete</a></td></tr>';var n=$("#instance_list tr").length;n>=2&&$("#instance_placeholder").remove().fadeOut(),$(s).append(a).fadeIn(),instances.setItem(e.server_info.server_id,{id:e.server_info.server_id,name:e.server_info.server_name,status:e.server_info.server_status,flavor:e.server_info.server_flavor,os:e.server_info.server_os,console:e.server_info.novnc_console}),instanceOpts.setItem(e.server_info.server_id,{value:e.server_info.server_id,option:e.server_info.server_name}),consoleLinks.setItem(e.server_info.server_id,{link:e.server_info.novnc_console,html:'<a href="'+e.server_info.novnc_console+'" class="open-instance-console" onClick="window.open(this.href,\'_blank\',\'toolbar=no, location=no, status=no, menubar=no, titlebar = no, scrollbars=yes, resizable=yes, width=720, height=435\'); return false;">console</a>'}),addToSelect(e.server_info.server_id,e.server_info.server_name,$("#instance"),attachableInstances),addToSelect(e.server_info.server_id,e.server_info.server_name,$("#assign_instance"),assignableInstances)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){checkAssignFip(),disableProgressbar(e,"instances",!0),setVisible("#create-instance",!0),disableLinks(!1),resetUiValidation(c)}),$(this).dialog("close")}}},close:function(){resetUiValidation(c)}})}),$(function(){var n,t,i;$(document).on("click",".delete-instance",function(e){e.preventDefault(),i=$(this).parent().parent(),n=$(i).attr("id"),t=document.getElementById(n+"-name-text"),$("div#instance-delete-confirm-form > p > span.instance-name").empty().append($(t).text()),$("#instance-delete-confirm-form").dialog("open")}),$("#instance-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var r=i,o=n,c=$(t).text();message.showMessage("notice","Deleting "+c+".");var d=document.getElementById(o+"-actions-cell"),l=d.innerHTML;disableLinks(!0),disableActions("delete-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var p=o+"-loader",u='<div class="ajax-loader" id="'+p+'"></div>';$(d).empty().fadeOut(),$(d).append(u).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+o+"/delete_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(d).empty().fadeOut(),$(d).append(l).fadeIn()),"success"==e.status){message.showMessage("success",e.message),$(r).fadeOut().remove(),removeFromSelect(o,$("#instance"),attachableInstances),removeFromSelect(o,$("#assign_instance"),assignableInstances),(assignableFips.length<=0||assignableInstances.length<=0)&&setVisible("#assign_ip",!1);for(var n=0;n<e.vols.length;n++){var t=document.getElementById(e.vols[n]+"-attached-cell");$(t).empty().fadeOut(),$(t).parent().removeClass("volume-attached");var i='<span id="'+e.vols[n]+'-attached-placeholder">No Attached Instance</span>';$(t).append(i).fadeIn();var c=document.getElementById(e.vols[n]+"-actions-cell");$(c).empty().fadeOut();var p='<a href="#" class="attach-volume">attach</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a>';$(c).append(p).fadeIn()}for(var u=0;u<e.floating_ip.length;u++){var f=document.getElementById(e.floating_ip_id[u]+"-instance-cell");$(f).empty().fadeOut(),$(f).parent().removeClass("fip-assigned");var m='<span id="'+e.floating_ip[u]+'-instance-name">None</span>';$(f).append(m).fadeIn();var v=document.getElementById(e.floating_ip_id[u]+"-actions-cell");$(v).empty().fadeOut();var g='<a id="'+e.floating_ip_id[u]+'" class="deallocate_ip" href="#">deallocate</a>';$(v).append(g).fadeIn()}instances.removeItem(o),instanceOpts.removeItem(o);var h=$("#instance_list tr").length;2>h&&$(s).append(a).fadeIn()}}).fail(function(){message.showMessage("error","Server Fault"),$(d).empty().fadeOut(),$(d).append(l).fadeIn()}).always(function(){checkAssignFip(),disableProgressbar(e,"instances",!0),disableActions("delete-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,n;$(document).on("click",".pause-instance",function(e){e.preventDefault(),n=$(this).parent().parent(),s=$(n).attr("id"),a=document.getElementById(s+"-name-text"),$("div#instance-pause-confirm-form > p > span.instance-name").empty().append($(a).text()),$("#instance-pause-confirm-form").dialog("open")}),$("#instance-pause-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var t=s,i=$(a).text();message.showMessage("notice","Pausing "+i+".");var r=document.getElementById(t+"-actions-cell"),o=r.innerHTML;disableLinks(!0),disableActions("pause-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var c=t+"-loader",d='<div class="ajax-loader" id="'+c+'"></div>';$(r).empty().fadeOut(),$(r).append(d).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+t+"/pause_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(o).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(t+"-status-cell");$(s).fadeOut().empty(),$(s).append("PAUSED").fadeIn();var a='<a href="#" class="unpause-instance '+t+'-disable-action">unpause</a><span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+t+'-disable-action">delete</a>';$(r).fadeOut().empty(),$(r).append(a).fadeIn(),$(n).addClass("instance-paused"),instances.items[t].status="PAUSED"}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(o).fadeIn()}).always(function(){disableProgressbar(e,"instances",!0),disableActions("pause-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,n;$(document).on("click",".unpause-instance",function(e){e.preventDefault(),n=$(this).parent().parent(),s=$(n).attr("id"),a=document.getElementById(s+"-name-text"),$("div#instance-unpause-confirm-form > p > span.instance-name").empty().append($(a).text()),$("#instance-unpause-confirm-form").dialog("open")}),$("#instance-unpause-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var t=s,i=$(a).text(),r=consoleLinks.items[t].html;message.showMessage("notice","Unpausing "+i+".");var o=document.getElementById(t+"-actions-cell"),c=o.innerHTML;disableLinks(!0),disableActions("unpause-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var d=t+"-loader",l='<div class="ajax-loader" id="'+d+'"></div>';$(o).empty().fadeOut(),$(o).append(l).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+t+"/unpause_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(o).empty().fadeOut(),$(o).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(t+"-status-cell");$(s).fadeOut().empty(),$(s).append("ACTIVE").fadeIn();var a=r+'<span class="instance-actions-pipe"> | </span><a href="#" class="pause-instance '+t+'-disable-action">pause</a><span class="instance-actions-pipe"> | </span><a href="#" class="suspend-instance '+t+'-disable-action">suspend</a><span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+t+'-disable-action">delete</a>';$(o).fadeOut().empty(),$(o).append(a).fadeIn(),$(n).removeClass("instance-paused"),instances.items[t].status="ACTIVE"}}).fail(function(){message.showMessage("error","Server Fault"),$(o).empty().fadeOut(),$(o).append(c).fadeIn()}).always(function(){disableProgressbar(e,"instances",!0),disableActions("unpause-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,n;$(document).on("click",".suspend-instance",function(e){e.preventDefault(),n=$(this).parent().parent(),s=$(n).attr("id"),a=document.getElementById(s+"-name-text"),$("div#instance-suspend-confirm-form > p > span.instance-name").empty().append($(a).text()),$("#instance-suspend-confirm-form").dialog("open")}),$("#instance-suspend-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var t=s,i=$(a).text();message.showMessage("notice","Suspending "+i+".");var r=document.getElementById(t+"-actions-cell"),o=r.innerHTML;disableLinks(!0),disableActions("suspend-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var c=t+"-loader",d='<div class="ajax-loader" id="'+c+'"></div>';$(r).empty().fadeOut(),$(r).append(d).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+t+"/suspend_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(o).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(t+"-status-cell");$(s).fadeOut().empty(),$(s).append("SUSPENDED").fadeIn();var a='<a href="#" class="resume-instance '+t+'-disable-action">resume</a><span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+t+'-disable-action">delete</a>';$(r).fadeOut().empty(),$(r).append(a).fadeIn(),$(n).addClass("instance-suspended"),instances.items[t].status="SUSPENDED"}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(o).fadeIn()}).always(function(){disableProgressbar(e,"instances",!0),disableActions("suspend-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,n;$(document).on("click",".resume-instance",function(e){e.preventDefault(),n=$(this).parent().parent(),s=$(n).attr("id"),a=document.getElementById(s+"-name-text"),$("div#instance-resume-confirm-form > p > span.instance-name").empty().append($(a).text()),$("#instance-resume-confirm-form").dialog("open")}),$("#instance-resume-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var t=s,i=$(a).text(),r=consoleLinks.items[t].html;message.showMessage("notice","Resuming "+i+".");var o=document.getElementById(t+"-actions-cell"),c=o.innerHTML;disableLinks(!0),disableActions("resume-instance",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"instances",!1);var d=t+"-loader",l='<div class="ajax-loader" id="'+d+'"></div>';$(o).empty().fadeOut(),$(o).append(l).fadeIn(),$.getJSON("/server/"+PROJECT_ID+"/"+t+"/resume_server/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(o).empty().fadeOut(),$(o).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s=document.getElementById(t+"-status-cell");$(s).fadeOut().empty(),$(s).append("ACTIVE").fadeIn();var a=r+'<span class="instance-actions-pipe"> | </span><a href="#" class="pause-instance '+t+'-disable-action">pause</a><span class="instance-actions-pipe"> | </span><a href="#" class="suspend-instance '+t+'-disable-action">suspend</a><span class="instance-actions-pipe"> | </span><a href="#" class="delete-instance '+t+'-disable-action">delete</a>';$(o).fadeOut().empty(),$(o).append(a).fadeIn(),$(n).removeClass("instance-suspended"),instances.items[t].status="ACTIVE"}}).fail(function(){message.showMessage("error","Server Fault"),$(o).empty().fadeOut(),$(o).append(c).fadeIn()}).always(function(){disableProgressbar(e,"instances",!0),disableActions("resume-instance",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})})});
/* keypair */ $(function(){var e=$("#keypair_progressbar"),a=$("#keypair_list"),s='<tr id="#keypair_placeholder"><td><p><i>You have no keys defined</i></p></td><td></td><td></td></tr>';$(function(){var s=$("#key_name"),t=$([]).add(s);$("#create-keypair").click(function(e){e.preventDefault(),$("#keypair-dialog-form").dialog("open")}),$("#keypair-dialog-form").dialog({autoOpen:!1,height:225,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Key Pair":function(){clearUiValidation(t);var i=checkLength(s,"key name",3,16);if(i){var n=s.val();message.showMessage("notice","Creating new Key "+n),setVisible("#create-keypair",!1),disableLinks(!0),$(e).progressbar({value:!1}),setVisible(e,!0),$.getJSON("/create_sec_keys/"+n+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var s="";s+='<tr id="'+e.key_id+'"><td id="'+e.key_id+'-name-cell"><a href="/key_pair/'+e.key_id+"/"+PROJECT_ID+'/view/" class="disable-link" style="color:#696969;"><span id="'+e.key_id+'-name-text">'+e.key_name+'</span></a></td><td id="'+e.key_id+'-user-cell"><span id="'+e.key_id+'-user-text">'+USERNAME+'</span></td><td id="'+e.key_id+'-actions-cell"><a href="#" class="delete-keypair">delete</a></td></tr>';var t=$("#keypair_list tr").length;2>=t&&$("#keypair_placeholder").remove().fadeOut(),a.append(s).fadeIn(),addToSelect(e.key_name,e.key_name,$("#sec_key_name"),secKeyInstOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){setVisible(e,!1),setVisible("#create-keypair",!0),disableLinks(!1),resetUiValidation(t)}),$(this).dialog("close")}}},close:function(){resetUiValidation(t)}})}),$(function(){var a,t="",i="";$(document).on("click",".delete-keypair",function(e){e.preventDefault(),a=$(this).parent().parent(),t=$(a).attr("id"),i=document.getElementById(t+"-name-text"),$("div#keypair-delete-confirm-form > p > span.keypair-name").empty().append($(i).text()),$("#keypair-delete-confirm-form").dialog("open")}),$("#keypair-delete-confirm-form").dialog({autoOpen:!1,height:125,width:200,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=t,r=$(i).text(),o=document.getElementById(n+"-actions-cell"),d=o.innerHTML;message.showMessage("notice","Deleting "+r+"."),disableLinks(!0),$(e).progressbar({value:!1}),setVisible(e,!0);var l=n+"-loader",c='<div class="ajax-loader" id="'+l+'"></div>';$(o).empty().fadeOut(),$(o).append(c).fadeIn(),$.getJSON("/key_pair/"+r+"/"+PROJECT_ID+"/delete/").done(function(e){"error"==e.status&&(message.showMessage("error",e.message),console.log(e),$(o).empty().fadeOut(),$(o).append(d).fadeIn()),"success"==e.status&&(message.showMessage("success",e.message),$(a).fadeOut().remove(),removeFromSelect(r,$("#sec_key_name"),secKeyInstOpts));var t=$("#keypair_list tr").length;2>t&&$("#keypair_list").append(s).fadeIn()}).fail(function(){message.showMessage("error","Server Fault"),$(o).empty().fadeOut(),$(o).append(d).fadeIn()}).always(function(){disableLinks(!1),setVisible(e,!1)}),$(this).dialog("close")}},close:function(){}})})});
/* private network */ $(function(){var e=$("#privateNet_progressbar"),t=$("#privateNet_list"),r='<tr id="privateNet_placeholder"><td><p><i>This project has no privateNets</i></p></td><td></td><td></td><td></td></tr>';$(function(){$("#privateNet_placeholder").length&&setVisible("#create-router",!1)}),$(function(){var r=$("#privateNet_name"),a=$("#admin_state"),s=$("#shared"),i=$([]).add(r).add(a).add(s);$("#create-private-network").click(function(e){e.preventDefault(),$("#private-network-dialog-form").dialog("open")}),$("#private-network-dialog-form").dialog({autoOpen:!1,height:350,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Private Network":function(){clearUiValidation(i);var n=checkLength(r,"Network Name",3,16)&&checkDuplicateName(r,privateNetworks);if(n){var o=r.val(),d=s.val(),l=a.val();message.showMessage("notice","Creating new network "+o),disableLinks(!0),setVisible("#create-private-network",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"privateNets",!1),$.getJSON("/add_private_network/"+o+"/"+l+"/"+d+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var r='<tr id="'+e.net_id+'"><td id="'+e.net_id+'-name-cell"><a href="/network/'+e.net_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.net_id+'-name-text">'+e.net_name+'</span></a></td><td id="'+e.net_id+'-status-cell">shared: <span id="'+e.net_id+'-shared-text">'+d+'</span><span id="{{ value.net_id }}-status-pipe"> | </span>admin state: <span id="'+e.net_id+'-admin-text">'+l+'</span></td><td id="'+e.net_id+'-subnet-cell"><span id="'+e.subnet.subnet_id+'">'+e.subnet.subnet_name+'</span></td><td id="'+e.net_id+'-actions-cell"><a href="#" class="delete-privateNet">delete</a></td></tr>';t.append(r).fadeIn();var a=$("#privateNet_list tr").length;a>2&&$("#privateNet_placeholder").remove().fadeOut(),privateNetworks.setItem(e.net_id,{id:e.net_id,name:e.net_name,router:"None"}),addToSelect(e.net_name,e.net_name,$("#network_name"),privNetInstOpts),addToSelect(e.net_id,e.net_name,$("#priv_net"),privNetRoutOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"privateNets",!0),setVisible("#create-private-network",!0),disableLinks(!1),resetUiValidation(i),checkCreateRouter()}),$(this).dialog("close")}}},close:function(){resetUiValidation(i)}})}),$(function(){var a,s,i;$(document).on("click",".delete-privateNet",function(e){e.preventDefault(),i=$(this).parent().parent(),a=$(i).attr("id"),s=document.getElementById(a+"-name-text"),$("div#private-network-delete-confirm-form > p > span.privateNet-name").empty().append($(s).text()),$("#private-network-delete-confirm-form").dialog("open")}),$("#private-network-delete-confirm-form").dialog({autoOpen:!1,height:150,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var n=a,o=$(s).text(),d=i;message.showMessage("notice","Deleting "+o+".");var l=document.getElementById(n+"-actions-cell"),p=l.innerHTML;disableLinks(!0),disableActions("delete-privateNet",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"privateNets",!1);var c=n+"-loader",u='<div class="ajax-loader" id="'+c+'"></div>';$(l).empty().fadeOut(),$(l).append(u).fadeIn();var v=privateNetworks.items[n],m=v.router,g=$(document.getElementById(m));"None"!=m&&(g.addClass("router-deleted"),disableActions("delete-router",!0),$("#router_progressbar").progressbar({value:!1}),disableProgressbar("#router_progressbar","routers",!1)),$.getJSON("/delete_private_network/"+PROJECT_ID+"/"+n+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(l).empty().fadeOut(),$(l).append(p).fadeIn(),"None"!=m&&(checkCreateRouter(),disableProgressbar("#router_progressbar","routers",!0),disableActions("delete-router",!1),disableLinks(!1),g.removeClass("router-deleted"))),"success"==e.status){message.showMessage("success",e.message),d.fadeOut().remove();var a=$("#privateNet_list tr").length;2>a&&($(t).append(r).fadeIn(),setVisible($("#create-router"),!1)),"None"!=m&&$.getJSON("/delete_router/"+PROJECT_ID+"/"+m+"/").done(function(e){var t=m;if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message),g.fadeOut().remove();var r=$("#router_list tr").length;2>r&&$("#router_list").append('<tr id="router_placeholder"><td><p><i>This project has no routers</i></p></td><td></td><td></td></tr>').fadeIn(),routers.removeItem(t)}}).fail(function(){message.showMessage("error","Server Fault"),g.removeClass("router-deleted")}).always(function(){checkCreateRouter(),disableProgressbar("#router_progressbar","routers",!0),disableActions("delete-router",!1),disableLinks(!1)}),privateNetworks.removeItem(n),removeFromSelect(o,$("#network_name"),privNetInstOpts),removeFromSelect(n,$("#priv_net"),privNetRoutOpts)}}).fail(function(){message.showMessage("error","Server Fault"),$(l).empty().fadeOut(),$(l).append(p).fadeIn()}).always(function(){disableProgressbar(e,"privateNets",!0),disableActions("delete-privateNet",!1),"None"==m&&disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})})});
/* project */ $(function(){$(function(){$("#delete-project").click(function(e){e.preventDefault(),$("#project-delete-confirm-form").dialog("open")}),$("#project-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){message.showMessage("notice","Deleting Project"),disableUiButtons(".ui-button",!0),$.getJSON("/projects/"+PROJECT_ID+"/"+PROJECT+"/delete/").done(function(e){"error"==e.status&&(message.showMessage("error",e.message),disableUiButtons(".ui-button",!1)),"success"==e.status&&(message.showMessage("success",e.message),location.replace("/cloud/manage"))}).fail(function(){disableUiButtons(".ui-button",!1)})}},close:function(){}})})});
/* router */ $(function(){var e=$("#router_progressbar"),t=$("#router_list"),r='<tr id="router_placeholder"><td><p><i>This project has no routers</i></p></td><td></td><td></td></tr>';$(function(){var r=$("#router_name"),s=$("#priv_net"),o=$([]).add(r).add(s);$("#create-router").click(function(e){e.preventDefault(),$("#router-dialog-form").dialog("open")}),$("#router-dialog-form").dialog({autoOpen:!1,height:285,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Router":function(){clearUiValidation(o);var a=checkLength(r,"Router Name",3,16)&&checkDuplicateName(r,routers);if(a){var i=r.val(),n=s.val();message.showMessage("notice","Creating new router "+i),disableLinks(!0),setVisible("#create-router",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"routers",!1),$.getJSON("/create_router/"+i+"/"+n+"/"+DEFAULT_PUBLIC+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var r='<tr id="'+e.router_id+'"><td id="'+e.router_id+'-name-cell"><a href="/router/'+e.router_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.router_id+'-name-text">'+e.router_name+'</span></a></td><td id="'+e.router_id+'-status-cell"><span id="'+e.router_id+'-status-text">ACTIVE</span></td><td id="'+e.router_id+'-actions-cell"><a href="#" class="delete-router">delete</a></td></tr>',s=$("#router_list tr").length;2>=s&&$("#router_placeholder").remove().fadeOut(),t.append(r).fadeIn(),routers.setItem(e.router_id,{name:e.router_name,network:n}),removeFromSelect(n,$("#priv_net"),privNetRoutOpts),privateNetworks.items[n].router=e.router_id}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"routers",!0),setVisible("#create-router",!0),disableLinks(!1),resetUiValidation(o)}),$(this).dialog("close")}}},close:function(){resetUiValidation(o)}})}),$(function(){var s,o,a;$(document).on("click",".delete-router",function(e){e.preventDefault(),a=$(this).parent().parent(),s=$(a).attr("id"),o=document.getElementById(s+"-name-text"),$("div#router-delete-confirm-form > p > span.router-name").empty().append($(o).text()),$("#router-delete-confirm-form").dialog("open")}),$("#router-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=s,n=$(o).text(),d=a;message.showMessage("notice","Deleting "+n+".");var u=document.getElementById(i+"-actions-cell"),l=u.innerHTML;disableLinks(!0),disableActions("delete-router",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"routers",!1);var c=i+"-loader",m='<div class="ajax-loader" id="'+c+'"></div>';$(u).empty().fadeOut(),$(u).append(m).fadeIn(),$.getJSON("/delete_router/"+PROJECT_ID+"/"+i+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(u).empty().fadeOut(),$(u).append(l).fadeIn()),"success"==e.status){message.showMessage("success",e.message),d.fadeOut().remove();var s=$("#router_list tr").length;2>s&&$(t).append(r).fadeIn(),routers.items[i].network&&(addToSelect(routers.items[i].network,privateNetworks.items[routers.items[i].network].name,$("#priv_net"),privNetRoutOpts),privateNetworks.items[routers.items[i].network].router="None"),routers.removeItem(i)}}).fail(function(){message.showMessage("error","Server Fault"),$(u).empty().fadeOut(),$(u).append(l).fadeIn()}).always(function(){disableProgressbar(e,"routers",!0),disableLinks(!1),disableActions("delete-router",!1)}),$(this).dialog("close")}},close:function(){}})})});
/* sec group */ $(function(){var e=$("#secGroup_progressbar"),s=$("#secGroup_list"),t='<tr id="#secGroup_placeholder"><td><p><i>You have no keys defined</i></p></td><td></td><td></td></tr>';$(function(){var t=$("#ports"),a=$("#groupname"),o=$("#groupdesc"),r=$([]).add(t).add(a).add(o);$("#create-security-group").click(function(e){e.preventDefault(),$("#sec-group-dialog-form").dialog("open")}),$("#sec-group-dialog-form").dialog({autoOpen:!1,height:410,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create a security group":function(){clearUiValidation(r);var i=checkLength(a,"Group Name",3,16)&&checkLength(o,"Group Description",6,80);if(i){var n=t.val(),c=$("input[name=transport]:checked").val(),d=a.val(),l=o.val();""==n&&(n="443,80,22"),void 0==c&&(c="tcp"),message.showMessage("notice","Creating new Key "+d),setVisible("#create-security-group",!1),disableLinks(!0),$(e).progressbar({value:!1}),setVisible(e,!0),$.getJSON("/create_security_group/"+d+"/"+l+"/"+n+"/"+c+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var t="";t+='<tr id="'+e.sec_group_id+'"><td id="'+e.sec_group_id+'-name-cell"><a href="/security_group/'+e.sec_group_id+"/"+PROJECT_ID+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.sec_group_id+'-name-text">'+e.sec_group_name+'</span></td><td id="'+e.sec_group_id+'-username-cell"><span id="'+e.sec_group_id+'-username-text">'+e.username+'</span></td><td id="'+e.sec_group_id+'-actions-cell"><a href="#" class="delete-secGroup">delete</a></tr>';var a=$("#secGroup_list tr").length;2>=a&&$("#secGroup_placeholder").remove().fadeOut(),s.append(t).fadeIn(),addToSelect(e.sec_group_name,e.sec_group_name,$("#sec_group_name"),secGroupInstOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){setVisible(e,!1),setVisible("#create-security-group",!0),disableLinks(!1),resetUiValidation(r),$("input#tcp").prop("checked",!0),t.val("443,80,22")}),$(this).dialog("close")}else;}},close:function(){resetUiValidation(r)}})}),$(function(){var s,a="",o="";$(document).on("click",".delete-secGroup",function(e){e.preventDefault(),s=$(this).parent().parent(),a=$(s).attr("id"),o=document.getElementById(a+"-name-text"),$("div#sec-group-delete-confirm-form > p > span.secGroup-name").empty().append($(o).text()),$("#sec-group-delete-confirm-form").dialog("open")}),$("#sec-group-delete-confirm-form").dialog({autoOpen:!1,height:125,width:245,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var r=a,i=$(o).text(),n=document.getElementById(r+"-actions-cell"),c=n.innerHTML;message.showMessage("notice","Deleting "+i+"."),disableLinks(!0),disableActions("delete-secGroup",!0),$(e).progressbar({value:!1}),setVisible(e,!0);var d=r+"-loader",l='<div class="ajax-loader" id="'+d+'"></div>';$(n).empty().fadeOut(),$(n).append(l).fadeIn(),$.getJSON("/delete_sec_group/"+r+"/"+PROJECT_ID+"/").done(function(e){"error"==e.status&&(message.showMessage("error",e.message),$(n).empty().fadeOut(),$(n).append(c).fadeIn()),"success"==e.status&&(message.showMessage("success",e.message),$(s).fadeOut().remove());var a=$("#secGroup_list tr").length;2>a&&$("#secGroup_list").append(t).fadeIn(),removeFromSelect(i,$("#sec_group_name"),secGroupInstOpts)}).fail(function(){message.showMessage("error","Server Fault"),$(n).empty().fadeOut(),$(n).append(c).fadeIn()}).always(function(){disableLinks(!1),disableActions("delete-secGroup",!1),setVisible(e,!1)}),$(this).dialog("close")}},close:function(){}})})});
/* snapshot */ $(function(){var e=$("#snapshot_progressbar"),s=$("#snapshot_list"),a='<tr id="snapshot_placeholder"><td><p><i>This project has no snapshots</i></p></td><td></td><td></td></tr>';$(document).ready(function(){$("#volume_placeholder").length&&setVisible("#create-snapshot",!1)}),$(function(){var a=$("#snap_name"),t=$("#snap_volume"),n=$("#snap_desc"),o=$([]).add(a).add(t).add(n);$("#create-snapshot").click(function(e){e.preventDefault(),$("#snapshot-dialog-form").dialog("open")}),$("#snapshot-dialog-form").dialog({autoOpen:!1,height:350,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Snapshot":function(){clearUiValidation(o);var i=checkLength(a,"Snapshot Name",3,16)&&checkLength(n,"Snapshot Name",1,80);if(i){var d=a.val(),l=t.val(),r=n.val();message.showMessage("notice","Creating new snapshot "+d),disableLinks(!0),setVisible("#create-snapshot",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"snapshots",!1),$.getJSON("/create_snapshot/"+PROJECT_ID+"/"+d+"/"+l+"/"+r+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a='<tr id="'+e.snapshot_id+'"><td id="'+e.snapshot_id+'-name-cell"><a href="/snapshot/'+e.snapshot_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.snapshot_id+'-name-text">'+e.snapshot_name+'</span></a></td><td id="'+e.snapshot_id+'-volume-cell"><span id="'+e.snapshot_id+'-volume-text">'+volumes.getItem(e.volume_id).name+'</span></td><td id="'+e.snapshot_id+'-actions-cell"><a href="#" class="delete-snapshot">delete</a></td></tr>';s.append(a).fadeIn();var t=$("#snapshot_list tr").length;t>2&&$("#snapshot_placeholder").remove().fadeOut(),snapshots.setItem(e.snapshot_id,{id:e.snapshot_id,name:e.snapshot_name,volumeId:e.volume_id,volumeName:volumes.getItem(e.volume_id).name})}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"snapshots",!0),setVisible("#create-snapshot",!0),disableLinks(!1),resetUiValidation(o)}),$(this).dialog("close")}}},close:function(){resetUiValidation(o)}})}),$(function(){var t,n,o;$(document).on("click",".delete-snapshot",function(e){e.preventDefault(),o=$(this).parent().parent(),t=$(o).attr("id"),n=document.getElementById(t+"-name-text"),$("div#snapshot-delete-confirm-form > p > span.snapshot-name").empty().append($(n).text()),$("#snapshot-delete-confirm-form").dialog("open")}),$("#snapshot-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=t,d=$(n).text(),l=o;message.showMessage("notice","Deleting "+d+".");var r=document.getElementById(i+"-actions-cell"),p=r.innerHTML;disableLinks(!0),disableActions("delete-snapshot",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"snapshots",!1);var c=i+"-loader",h='<div class="ajax-loader" id="'+c+'"></div>';$(r).empty().fadeOut(),$(r).append(h).fadeIn(),$.getJSON("/delete_snapshot/"+PROJECT_ID+"/"+i+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(p).fadeIn()),"success"==e.status){message.showMessage("success",e.message),l.fadeOut().remove();var t=$("#snapshot_list tr").length;2>t&&$(s).append(a).fadeIn(),snapshots.removeItem(i)}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(p).fadeIn()}).always(function(){disableProgressbar(e,"snapshots",!0),disableLinks(!1),disableActions("delete-snapshot",!1)}),$(this).dialog("close")}},close:function(){}})})});
/* user */ $(function(){var e=$("#users_progressbar"),s=$("#users_list"),a='<tr id="users_placeholder"><td><p><i>This project has no images</i></p></td><td></td></tr>';$(function(){var a=$("#username"),r=$("#email"),t=$("#password"),n=$("#confirm"),i=$("#role"),o=$([]).add(a).add(r).add(t).add(n).add(i);$("#create-user").click(function(e){e.preventDefault(),$("#user-dialog-form").dialog("open")}),$("#user-dialog-form").dialog({autoOpen:!1,height:475,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Account":function(){clearUiValidation(o);var d=checkLength(a,"username",3,16)&&checkUsername(a)&&checkDuplicateName(a,users)&&checkLength(r,"email",6,80)&&checkEmail(r)&&checkLength(t,"password",5,16)&&checkPassword(t)&&checkPasswordMatch(t,n);if(d){var l=a.val(),u=t.val(),c=r.val(),m=i.val();message.showMessage("notice","Creating new user "+a.val()),setVisible("#create-user",!1),setVisible("#add-existing-user",!1),disableLinks(!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1),$.getJSON("/create_user/"+l+"/"+u+"/"+m+"/"+c+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var a="";a+='<tr id="'+e.user_id+'"><td id="'+e.user_id+'-name-cell"><a href="/projects/'+PROJECT+"/"+PROJECT_ID+"/user/"+e.username+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.user_id+'-name-text">'+l+'</span></a><a href="mailto:'+c+'"><span id="'+e.user_id+'-email-text"> ('+c+')</span></a><span id="'+e.user_id+'-role-text"> '+m+'</span></td><td id="'+e.user_id+'-actions-cell"><a href="#" class="disable-user">disable</a><span class="user-actions-pipe"> | </span><a href="#" class="remove-user">remove</a><span class="user-actions-pipe"> | </span><a href="#" class="delete-user">delete</a></td></tr>';var r=$("#users_list tr").length;2>=r&&$("#users_placeholder").remove().fadeOut(),s.append(a).fadeIn(),users.setItem(e.username,{id:e.user_id,enabled:"TRUE",username:e.username,email:c,role:m,removed:"FALSE"})}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"users",!0),setVisible("#create-user",!0),disableLinks(!1),resetUiValidation(o),checkAddUser()}),$(this).dialog("close")}}},close:function(){resetUiValidation(o)}})}),$(function(){var r,t,n;$(document).on("click",".delete-user",function(e){e.preventDefault(),n=$(this).parent().parent(),r=$(n).attr("id"),t=document.getElementById(r+"-name-text"),$("div#user-delete-confirm-form > p > span.user-name").empty().append($(t).text()),$("#user-delete-confirm-form").dialog("open")}),$("#user-delete-confirm-form").dialog({autoOpen:!1,height:125,width:200,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=n,o=r,d=$(t).text();message.showMessage("notice","Deleting "+d+".");var l=document.getElementById(o+"-actions-cell"),u=l.innerHTML;disableLinks(!0),disableActions("delete-user",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1);var c=o+"-loader",m='<div class="ajax-loader" id="'+c+'"></div>';$(l).empty().fadeOut(),$(l).append(m).fadeIn(),$.getJSON("/delete_user/"+d+"/"+o+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(l).empty().fadeOut(),$(l).append(u).fadeIn()),"success"==e.status){message.showMessage("success",e.message),i.fadeOut().remove(),users.removeItem(d);var r=$("#users_list tr").length;2>r&&$(s).append(a).fadeIn()}}).fail(function(){message.showMessage("error","Server Fault"),$(l).empty().fadeOut(),$(l).append(u).fadeIn()}).always(function(){disableProgressbar(e,"users",!0),disableActions("delete-user",!1),disableLinks(!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var a=$("#username"),r=$("#role");$("#add-existing-user").click(function(e){e.preventDefault(),$("#user-add-existing-dialog-form").dialog("open")}),$("#user-add-existing-dialog-form").dialog({autoOpen:!1,height:300,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Add Existing User":function(){var t=a.val(),n=r.val();message.showMessage("notice","Adding existing user "+t+"."),setVisible("#create-user",!1),setVisible("#add-existing-user",!1),disableLinks(!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1),$.getJSON("/add_existing_user/"+t+"/"+n+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message),users.items[t].removed="FALSE",users.items[t].role=n;var a='<tr id="'+users.items[t].id+'" class="';a+="FALSE"==users.items[t].enabled?'user-disabled">':'">',a+='<td id="'+users.items[t].id+'-name-cell"><a href="/projects/'+PROJECT+"/"+PROJECT_ID+"/user/"+users.items[t].username+'/view/" class="disable-link"><span id="'+users.items[t].id+'-name-text">'+users.items[t].username+'</span></a><a href="mailto:'+users.items[t].email+'"><span id="'+users.items[t].id+'-email-text"> ('+users.items[t].email+') </span></a><span id="'+users.items[t].id+'-role-text" class="right">'+users.items[t].role+'</span></td><td id="'+users.items[t].id+'-actions-cell">',a+="TRUE"==users.items[t].enabled?'<a href="#" class="disable-user">disable</a>':'<a href="#" class="enable-user">enable</a>',a+='<span class="user-actions-pipe"> | </span><a href="#" class="remove-user">remove</a><span class="user-actions-pipe"> | </span><a href="#" class="delete-user"> delete</a></td></tr>',s.append(a).fadeIn();var r=$("#users_list tr").length;r>=2&&$("#users_placeholder").remove().fadeOut(),removeFromSelect(t,$("select#username"),orphanedUserOpts)}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"users",!0),setVisible("#create-user",!0),disableLinks(!1),checkAddUser()}),$(this).dialog("close")}},close:function(){}})}),$(function(){var r,t,n;$(document).on("click",".remove-user",function(e){e.preventDefault(),n=$(this).parent().parent(),r=$(n).attr("id"),t=document.getElementById(r+"-name-text"),$("div#user-remove-confirm-form > p > span.user-name").empty().append($(t).text()),$("#user-remove-confirm-form").dialog("open")}),$("#user-remove-confirm-form").dialog({autoOpen:!1,height:125,width:200,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var i=n,o=r,d=$(t).text();message.showMessage("notice","Removing "+d+".");var l=document.getElementById(o+"-actions-cell"),u=l.innerHTML;disableLinks(!0),disableActions("remove-user",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1);var c=o+"-loader",m='<div class="ajax-loader" id="'+c+'"></div>';$(l).empty().fadeOut(),$(l).append(m).fadeIn(),$.getJSON("/remove_user_from_project/"+o+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(l).empty().fadeOut(),$(l).append(u).fadeIn()),"success"==e.status){message.showMessage("success",e.message),i.fadeOut().remove(),users.items[d].removed="TRUE",addToSelect(d,d,$("select#username"),orphanedUserOpts);var r=$("#users_list tr").length;2>r&&s.append(a).fadeIn()}}).fail(function(){message.showMessage("error","Server Fault"),$(l).empty().fadeOut(),$(l).append(u).fadeIn()}).always(function(){disableProgressbar(e,"users",!0),disableActions("remove-user",!1),disableLinks(!1),checkAddUser()}),$(this).dialog("close")}},close:function(){}})}),$(function(){var s,a,r;$(document).on("click",".enable-user",function(e){e.preventDefault(),r=$(this).parent().parent(),s=$(r).attr("id"),a=document.getElementById(s+"-name-text"),$("div#user-enable-confirm-form > p > span.user-name").empty().append($(a).text()),$("#user-enable-confirm-form").dialog("open")}),$("#user-enable-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var t=r,n=s,i=$(a).text();message.showMessage("notice","Enabling "+i+".");var o=document.getElementById(n+"-actions-cell"),d=o.innerHTML;disableLinks(!0),disableActions("enable-user",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1);var l=n+"-loader",u='<div class="ajax-loader" id="'+l+'"></div>';$(o).empty().fadeOut(),$(o).append(u).fadeIn(),$.getJSON("/toggle_user/"+i+"/enable/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(o).empty().fadeOut(),$(o).append(d).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s='<a href="#" class="disable-user">disable</a><span class="user-actions-pipe"> | </span><a href="#" class="remove-user">remove</a><span class="user-actions-pipe"> | </span><a href="#" class="delete-user"> delete</a>';$(o).empty().fadeOut(),$(o).append(s).fadeIn(),t.removeClass("user-disabled")}}).fail(function(){message.showMessage("error","Server Fault"),$(o).empty().fadeOut(),$(o).append(d).fadeIn()}).always(function(){disableProgressbar(e,"users",!0),disableActions("enable-user",!1),disableLinks(!1)}),$(this).dialog("close")},close:function(){}}})}),$(function(){var s,a,r;$(document).on("click",".disable-user",function(e){e.preventDefault(),r=$(this).parent().parent(),s=$(r).attr("id"),a=document.getElementById(s+"-name-text"),$("div#user-disable-confirm-form > p > span.user-name").empty().append($(a).text()),$("#user-disable-confirm-form").dialog("open")}),$("#user-disable-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var t=r,n=s,i=$(a).text();message.showMessage("notice","Disabling "+i+".");var o=document.getElementById(n+"-actions-cell"),d=o.innerHTML;disableLinks(!0),disableActions("disable-user",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"users",!1);var l=n+"-loader",u='<div class="ajax-loader" id="'+l+'"></div>';$(o).empty().fadeOut(),$(o).append(u).fadeIn(),$.getJSON("/toggle_user/"+i+"/disable/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(o).empty().fadeOut(),$(o).append(d).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var s='<a href="#" class="enable-user">enable</a><span class="user-actions-pipe"> | </span><a href="#" class="remove-user">remove</a><span class="user-actions-pipe"> | </span><a href="#" class="delete-user"> delete</a>';$(o).empty().fadeOut(),$(o).append(s).fadeIn(),t.addClass("user-disabled")}}).fail(function(){message.showMessage("error","Server Fault"),$(o).empty().fadeOut(),$(o).append(d).fadeIn()}).always(function(){disableProgressbar(e,"users",!0),disableActions("disable-user",!1),disableLinks(!1)}),$(this).dialog("close")},close:function(){}}})})});
/* volume */ $(function(){var e=$("#vol_progressbar"),a=$("#volume_list"),t='<tr id="volume_placeholder"><td><p><i>This project has no volumes</i></p></td><td></td><td></td>/tr>';$(function(){var t=$("#volume_name"),s=$("#volume_size"),o=$("#description"),n=$("#volume_type"),l=$([]).add(t).add(s).add(o).add(n);$(document).on("click","#create-volume",function(e){e.preventDefault(),$("#volume-dialog-form").dialog("open")}),$("#volume-dialog-form").dialog({autoOpen:!1,height:445,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Create Volume":function(){clearUiValidation(l);var d=checkLength(t,"Volume Name",3,16)&&checkDuplicateName(t,volumes)&&checkSize(s,"Volume Size must be greater than 0.",1,0)&&checkStorage(s)&&checkLength(o,"Description",1,16);if(d){var i=t.val(),r=s.val(),m=o.val(),c=n.val();message.showMessage("notice","Creating new volume "+t.val()),disableLinks(!0),setVisible("#create-volume",!1),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1),$.getJSON("/create_volume/"+i+"/"+r+"/"+m+"/"+c+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&message.showMessage("error",e.message),"success"==e.status){message.showMessage("success",e.message);var t='<tr id="'+e.volume_id+'" class="'+e.volume_size+'"><td id="'+e.volume_id+'-name-cell"><a href="/projects/'+PROJECT_ID+"/volumes/"+e.volume_id+'/view/" class="disable-link disabled-link" style="color:#696969;"><span id="'+e.volume_id+'-name-text">'+e.volume_name+'</span></a></td><td id="'+e.volume_id+'-attached-cell"><span id="'+e.volume_id+'-attached-placeholder">No Attached Instances</span></td><td id="'+e.volume_id+'-actions-cell"><a href="#" class="attach-volume">attach</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a></td></tr>',s=$("#volume_list tr").length;2>=s&&($("#volume_placeholder").remove().fadeOut(),setVisible("#create-snapshot",!0)),a.append(t).fadeIn(),volumes.setItem(e.volume_id,{size:e.volume_size,name:e.volume_name}),snapshotVolumes.setItem(e.volume_id,{value:e.volume_id,option:e.volume_name}),refreshSelect($("#snap_volume"),snapshotVolumes),updateUsedStorage(),updateStorageBar()}}).fail(function(){message.showMessage("error","Server Fault")}).always(function(){disableProgressbar(e,"volumes",!0),setVisible("#create-volume",!0),disableLinks(!1),resetUiValidation(l)}),$(this).dialog("close")}}},close:function(){resetUiValidation(l)}})}),$(function(){var s,o,n;$(document).on("click",".delete-volume",function(e){e.preventDefault(),n=$(this).parent().parent(),s=$(n).attr("id"),o=document.getElementById(s+"-name-text"),$("div#volume-delete-confirm-form > p > span.volume-name").empty().append($(o).text());var a=0;for(var t in snapshots.items){var l=snapshots.getItem(t).volumeId;console.log(l+" = "+s+" ?"),l==s&&a++}a>0?message.showMessage("error","Cannot delete this volume because it has "+a+" dependent snapshots."):$("#volume-delete-confirm-form").dialog("open")}),$("#volume-delete-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{Confirm:function(){var l=n,d=s,i=$(o).text();message.showMessage("notice","Deleting "+i+".");var r=document.getElementById(d+"-actions-cell"),m=r.innerHTML;disableLinks(!0),disableActions("delete-volume",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1);var c=d+"-loader",u='<div class="ajax-loader" id="'+c+'"></div>';$(r).empty().fadeOut(),$(r).append(u).fadeIn(),$.getJSON("/delete_volume/"+d+"/"+PROJECT_ID+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(r).empty().fadeOut(),$(r).append(m).fadeIn()),"success"==e.status){message.showMessage("success",e.message),l.fadeOut().remove(),volumes.removeItem(d),snapshotVolumes.removeItem(d),refreshSelect($("#snap_volume"),snapshotVolumes),updateUsedStorage(),updateStorageBar();var s=$("#volume_list tr").length;2>s&&($(a).append(t).fadeIn(),setVisible("#create-snapshot",!1))}}).fail(function(){message.showMessage("error","Server Fault"),$(r).empty().fadeOut(),$(r).append(m).fadeIn()}).always(function(){disableProgressbar(e,"volumes",!0),disableLinks(!1),disableActions("delete-volume",!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var a,t,s;$(document).on("click",".attach-volume",function(e){e.preventDefault(),s=$(this).parent().parent(),a=$(s).attr("id"),t=document.getElementById(a+"-name-text"),$("div#volume-attach-dialog-form > p > span.volume-name").empty().append($(t).text()),$("#volume-attach-dialog-form").dialog("open")}),$("#volume-attach-dialog-form").dialog({autoOpen:!1,height:225,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Attach Volume":function(){var o=$("#instance"),n=s,l=a,d=$(t).text(),i=instanceOpts.items[o.val()].value,r=instanceOpts.items[i].option;message.showMessage("notice","Attaching "+d+" to "+r+".");var m=document.getElementById(l+"-actions-cell"),c=m.innerHTML;disableLinks(!0),disableActions("attach-volume",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1);var u=l+"-loader",v='<div class="ajax-loader" id="'+u+'"></div>';$(m).empty().fadeOut(),$(m).append(v).fadeIn(),$.getJSON("/attach_volume/"+PROJECT_ID+"/"+i+"/"+l+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(m).empty().fadeOut(),$(m).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var a=document.getElementById(l+"-attached-cell");$(m).empty().fadeOut(),$(a).empty().fadeOut();var t='<a href="#" class="detach-volume">detach</a>';$(m).append(t).fadeIn(),$(a).append(r).fadeIn(),n.addClass("volume-attached")}}).fail(function(){message.showMessage("error","Server Fault"),$(m).empty().fadeOut(),$(m).append(c).fadeIn()}).always(function(){disableProgressbar(e,"volumes",!0),disableLinks(!1),disableActions("attach-volume",!1)}),$(this).dialog("close")}},close:function(){}})}),$(function(){var a,t,s,o=$("#instance");$(document).on("click",".detach-volume",function(e){e.preventDefault(),s=$(this).parent().parent(),a=s.attr("id"),t=document.getElementById(a+"-name-text"),$("div#volume-detach-confirm-form > p > span.volume-name").empty().append($(t).text()),$("#volume-detach-confirm-form").dialog("open")}),$("#volume-detach-confirm-form").dialog({autoOpen:!1,height:125,width:235,modal:!0,resizable:!1,closeOnEscape:!0,draggable:!0,show:"fade",position:{my:"center",at:"center",of:$("#page-content")},buttons:{"Detach Volume":function(){var n=s,l=a,d=$(t).text(),i=o.val(),r=instanceOpts.items[i].option;message.showMessage("notice","Detaching "+d+" from "+r+".");var m=document.getElementById(l+"-actions-cell"),c=m.innerHTML;disableLinks(!0),disableActions("detach-volume",!0),$(e).progressbar({value:!1}),disableProgressbar(e,"volumes",!1);var u=l+"-loader",v='<div class="ajax-loader" id="'+u+'"></div>';$(m).empty().fadeOut(),$(m).append(v).fadeIn(),$.getJSON("/detach_volume/"+PROJECT_ID+"/"+l+"/").done(function(e){if("error"==e.status&&(message.showMessage("error",e.message),$(m).empty().fadeOut(),$(m).append(c).fadeIn()),"success"==e.status){message.showMessage("success",e.message);var a=document.getElementById(l+"-attached-cell");$(m).empty().fadeOut(),$(a).empty().fadeOut();var t='<a href="#" class="attach-volume">attach</a><span class="volume-actions-pipe"> | </span><a href="#" class="delete-volume">delete</a>';$(m).append(t).fadeIn(),$(a).append("No Attached Instance").fadeIn(),n.removeClass("volume-attached")}}).fail(function(){message.showMessage("error","Server Fault"),$(m).empty().fadeOut(),$(m).append(c).fadeIn()}).always(function(){disableProgressbar(e,"volumes",!0),disableLinks(!1),disableActions("detach-volume",!1)}),$(this).dialog("close")}},close:function(){}})})});