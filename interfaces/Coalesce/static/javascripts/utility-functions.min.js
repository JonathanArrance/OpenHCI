function getCookie(e){var t=null;if(document.cookie&&""!=document.cookie)for(var s=document.cookie.split(";"),a=0;a<s.length;a++){var n=jQuery.trim(s[a]);if(n.substring(0,e.length+1)==e+"="){t=decodeURIComponent(n.substring(e.length+1));break}}return t}function csrfSafeMethod(e){return/^(GET|HEAD|OPTIONS|TRACE)$/.test(e)}function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return(S4()+S4()+S4()+"4"+S4().substr(0,3)+S4()+S4()+S4()+S4()).toLowerCase()}function convertUrl47(e){for(var t=0;t<e.length;t++)"/"==e[t]&&(e=e.substr(0,t)+"%47"+e.substr(t,e.length+1),t+=2);return e}function flagError(e,t){e.before('<div class="error">'+t+"</div>"),$("error").addClass("ui-state-highlight").fadeIn(),setTimeout(function(){$("error").removeClass("ui-state-highlight",1500)},500)}function checkLength(e,t,s,a){return e.val().length>a||e.val().length<s?(e.addClass("ui-state-error"),flagError(e,t+" must be between "+s+" and "+a+"."),!1):!0}function checkRange(e,t,s,a){return e.val()>a||e.val()<s?(e.addClass("ui-state-error"),flagError(e,t+" must be between "+s+" and "+a+"."),!1):!0}function checkRegexp(e,t,s){return t.test(e.val())?!0:(e.addClass("ui-state-error"),flagError(e,s),!1)}function checkUsername(e){var t=/^[a-z]([0-9a-z_])+$/i;return t.test(e.val())?!0:(e.addClass("ui-state-error"),flagError(e,"Username may consist of a-z, 0-9 and underscores, and must being with a letter."),!1)}function checkHostname(e){var t=/^([0-9a-z_])+$/i;return t.test(e.val())?!0:(e.addClass("ui-state-error"),flagError(e,"Hostname may consist of a-z, 0-9 and underscores."),!1)}function checkIp(e){var t=/^([01]?\\d\\d?|2[0-4]\\d|25[0-5])\\.([01]?\\d\\d?|2[0-4]\\d|25[0-5])\\.([01]?\\d\\d?|2[0-4]\\d|25[0-5])\\.([01]?\\d\\d?|2[0-4]\\d|25[0-5])$/i;return t.test(e.val())?!0:(e.addClass("ui-state-error"),flagError(e,"IP addresses must be formatted properly (ex: 255.255.255.255)"),!1)}function checkEmail(e){var t=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;return t.test(e.val())?!0:(e.addClass("ui-state-error"),flagError(e,"Email must formatted as: 'user@domain.com'."),!1)}function checkPassword(e){var t=/^([0-9a-zA-Z])+$/;return t.test(e.val())?!0:(e.addClass("ui-state-error"),flagError(e,"Password may consist of a-z and 0-9."),!1)}function checkPasswordMatch(e,t){return e.val()!=t.val()?(e.addClass("ui-state-error"),t.addClass("ui-state-error"),flagError(t,"Passwords do not match."),!1):!0}function checkStorage(e){return e.val()>availableStorage?(e.addClass("ui-state-error"),flagError(e,"There is only "+availableStorage+"gbs of available storage."),!1):!0}function checkUrl(e){var t=new RegExp("^(http|https|ftp)://([a-zA-Z0-9.-]+(:[a-zA-Z0-9.&%$-]+)*@)*((25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[1-9]|0).(25[0-5]|2[0-4][0-9]|[0-1]{1}[0-9]{2}|[1-9]{1}[0-9]{1}|[0-9])|([a-zA-Z0-9-]+.)*[a-zA-Z0-9-]+.(com|edu|gov|int|mil|net|org|biz|arpa|info|name|pro|aero|coop|museum|[a-zA-Z]{2}))(:[0-9]+)*(/($|[a-zA-Z0-9.,?'\\+&%$#=~_-]+))*$");return t.test(e.val())?!0:(e.addClass("ui-state-error"),flagError(e,"Invalid remote URL."),!1)}function checkFile(e){return""==e.val()?(e.addClass("ui-state-error"),flagError(e,"A local file must be selected."),!1):!0}function checkDuplicateName(e,t){var s=!0;for(item in t.items){var a=t.getItem(item);e.val()==a.option&&(s=!1)}return s||(e.addClass("ui-state-error"),flagError(e,"Name is already in use.")),s}function checkSize(e,t,s,a){var n=0==a;return n?e.val()<s||isNaN(Number(e.val()))?(e.addClass("ui-state-error"),flagError(e,t),!1):!0:e.val()<s||e.val()>a||isNaN(Number(e.val()))?(e.addClass("ui-state-error"),flagError(e,t),!1):!0}function clearUiValidation(e){e.removeClass("ui-state-error"),$(".error").each(function(){$(this).fadeOut().remove()})}function resetUiValidation(e){e.val("").removeClass("ui-state-error"),$(".error").each(function(){$(this).fadeOut().remove()})}function HashTable(){this.length=0,this.items=[];for(var e=0;e<arguments.length;e+=2)"undefined"!=typeof arguments[e+1]&&(this.items[arguments[e]]=arguments[e+1],this.length++);this.removeItem=function(e){var t;return"undefined"!=typeof this.items[e]&&(this.length--,t=this.items[e],delete this.items[e]),t},this.getItem=function(e){return this.items[e]},this.setItem=function(e,t){var s;return"undefined"!=typeof t&&("undefined"==typeof this.items[e]?this.length++:s=this.items[e],this.items[e]=t),s},this.hasItem=function(e){return"undefined"!=typeof this.items[e]},this.clear=function(){for(var e in this.items)delete this.items[e];this.length=0}}function disableLinks(e){var t=".disable-link",s="#AD682B",a="#696969";e?(0>=disabledLinks&&($(t).addClass("disabled-link"),$(t).css("color",a)),disabledLinks++):(disabledLinks--,0>=disabledLinks&&($(t).removeClass("disabled-link"),$(t).css("color",s),disabledLinks=0))}function disableProgressbar(e,t,s){s?(disabledProgressbars[t]--,disabledProgressbars[t]<=0&&$(e).is(":visible")&&($(e).fadeOut("fast"),disabledProgressbars[t]=0)):($(e).is(":hidden")&&$(e).fadeIn("fast"),disabledProgressbars[t]++)}function disableLink(e,t){var s="#AD682B",a="#696969";t?($(e).addClass("disabled-link"),$(e).css("color",a)):($(e).removeClass("disabled-link"),$(e).css("color",s))}function disableActions(e,t){var s="."+e,a="#AD682B",n="#696969";t?disabledActions.hasItem(s)?disabledActions.items[s].count++:(disabledActions.setItem(s,{count:1}),$(s).bind("click",!1),$(s).css("color",n)):(disabledActions.items[s].count--,disabledActions.items[s].count<=0&&($(s).unbind("click",!1),$(s).css("color",a),disabledActions.removeItem(s)))}function disableUiButtons(e,t){t?($(e).attr("disabled",!0),$(e).css("cursor","inherit")):($(e).attr("disabled",!1),$(e).css("cursor","pointer"))}function disableFormInputs(e,t,s){for(var a=0;a<t.length;a++){var n="."+e+"-"+t[a];$(n).each(function(){$(this).prop("disabled",s)})}}function setVisible(e,t){t?$(e).is(":hidden")&&$(e).fadeIn("fast"):$(e).is(":visible")&&$(e).fadeOut("fast")}function emptyAndAppend(e,t){fadeOutAndEmpty(e),setTimeout(function(){appendAndFadeIn(e,t)},500)}function fadeOutAndEmpty(e){setVisible(e,!1),$(e).empty()}function appendAndFadeIn(e,t){$(e).append(t),setVisible(e,!0)}function refreshSelect(e,t){$(e).empty();for(var s in t.items)$(e).append('<option value="'+t.items[s].value+'">'+t.items[s].option+"</option>")}function removeFromSelect(e,t,s){s.removeItem(e),refreshSelect(t,s)}function addToSelect(e,t,s,a){a.setItem(e,{value:e,option:t}),refreshSelect(s,a)}function checkAssignFip(){assignableFips.length>0&&assignableInstances.length>0?setVisible("#assign_ip",!0):setVisible("#assign_ip",!1)}function getStorage(){$.getJSON("/projects/"+PROJECT_ID+"/get_project_quota/").done(function(e){totalStorage=e.gigabytes,updateUsedStorage(),updateStorageBar()})}function updateUsedStorage(){usedStorage=0;for(var e in volumes.items){var t=volumes.getItem(e).size;usedStorage+=Number(t)}availableStorage=totalStorage-usedStorage}function updateStorageBar(){var e=$(".volume-available-storage-bar"),t=$(".volume-available-storage-label"),s=0;e.progressbar({value:0}),s=usedStorage/totalStorage*100,e.progressbar({value:s}),t.empty(),t.append(usedStorage+"/"+totalStorage)}function updateRevertVolumeSnapshots(e){var t=$("#revert_snapshot_name");t.empty();for(var s in snapshots.items)snapshots.items[s].volumeId==e&&t.append('<option value="'+s+'">'+snapshots.getItem(s).name+"</option>")}function checkCreateRouter(){privNetRoutOpts.length>0?setVisible("#create-router",!0):setVisible("#create-router",!1)}function checkAddUser(){orphanedUserOpts.length>0?setVisible("#add-existing-user",!0):orphanedUserOpts.length<=0&&setVisible("#add-existing-user",!1)}function getSecGroupPorts(){var e=0,t=0;tcpPorts=[],udpPorts=[],icmp="disabled";for(var s=0;s<secGroupPorts.length;s++)"tcp"==secGroupPorts[s].transport&&(tcpPorts[e]=parseInt(secGroupPorts[s].from_port),e++),"udp"==secGroupPorts[s].transport&&(udpPorts[t]=parseInt(secGroupPorts[s].from_port),t++),"icmp"==secGroupPorts[s].transport&&(icmp="enabled");tcpPorts.sort(function(e,t){return e-t}),udpPorts.sort(function(e,t){return e-t})}function updateSecGroupPorts(e){secGroupPorts=[];for(var t=0;t<e.length;t++)secGroupPorts[t]={from_port:e[t].from_port,to_port:e[t].to_port,transport:e[t].transport};getSecGroupPorts()}function updateTcpString(){tcpString="";for(var e=0;e<tcpPorts.length;e++)tcpPorts[e]>0&&(tcpString+=tcpPorts[e],e+1<tcpPorts.length&&(tcpString+=","))}function updateUdpString(){udpString="";for(var e=0;e<udpPorts.length;e++)udpPorts[e]>0&&(udpString+=udpPorts[e],e+1<udpPorts.length&&(udpString+=","))}function deleteCheck(e){$(document).ready(function(){var t=$(e).contents().filter(function(){return 3===this.nodeType});t.each(function(){this.previousSibling==document.getElementById("delete-check")&&$(this).remove()})})}var message=new message_handle,consoleLinks=new HashTable;$(document).on("click",".open-instance-console",function(e){e.preventDefault()}),$(document).on("click","#refresh-console",function(){$(".widget-console").attr("src",function(e,t){return t})});var csrftoken=getCookie("csrftoken");$.ajaxSetup({crossDomain:!1,beforeSend:function(e,t){csrfSafeMethod(t.type)||e.setRequestHeader("X-CSRFToken",csrftoken)}});var disabledLinks=0,disabledProgressbars={instances:0,images:0,fips:0,volumes:0,snapshots:0,containers:0,extNets:0,routers:0,privateNets:0,users:0,secGroups:0,keys:0},disabledActions=new HashTable,instanceManagementHidden=!1;$(function(){$("#instance-management").click(function(e){e.preventDefault(),$(".instance-management-well").each(function(e,t){$(t).hasClass("well-hidden")||(instanceManagementHidden=!1)}),instanceManagementHidden?($(".instance-management-table").show(0),$(".instance-management-well").removeClass("well-hidden"),$("#instance-management-icon").text("-"),instanceManagementHidden=!1):($(".instance-management-table").hide(0),$(".instance-management-well").addClass("well-hidden"),$("#instance-management-icon").text("+"),instanceManagementHidden=!0)})});var instances=new HashTable,instanceSnaps=new HashTable,instanceOpts=new HashTable,secGroupInstOpts=new HashTable,secKeyInstOpts=new HashTable,privNetInstOpts=new HashTable,imageInstOpts=new HashTable,assignableFips=new HashTable,assignableInstances=new HashTable;$(function(){checkAssignFip()});var storageHidden=!1;$(function(){$("#storage").click(function(e){e.preventDefault(),$(".storage-well").each(function(e,t){$(t).hasClass("well-hidden")||(storageHidden=!1)}),storageHidden?($(".storage-table").show(0),$(".storage-well").removeClass("well-hidden"),$("#storage-icon").text("-"),storageHidden=!1):($(".storage-table").hide(0),$(".storage-well").addClass("well-hidden"),$("#storage-icon").text("+"),storageHidden=!0)})});var volumes=new HashTable,totalStorage=0,usedStorage=0,availableStorage=0,attachableInstances=new HashTable,snapshots=new HashTable,snapshotVolumes=new HashTable,sdnHidden=!1;$(function(){$("#software-defined-networking").click(function(e){e.preventDefault(),$(".sdn-well").each(function(e,t){$(t).hasClass("well-hidden")||(sdnHidden=!1)}),sdnHidden?($(".sdn-table").show(0),$(".sdn-well").removeClass("well-hidden"),$("#sdn-icon").text("-"),sdnHidden=!1):($(".sdn-table").hide(0),$(".sdn-well").addClass("well-hidden"),$("#sdn-icon").text("+"),sdnHidden=!0)})});var routers=new HashTable,privNetRoutOpts=new HashTable,privateNetworks=new HashTable;$(function(){checkCreateRouter()});var usersSecurityHidden=!1;$(function(){$("#users-security").click(function(e){e.preventDefault(),$(".user-well").each(function(e,t){$(t).hasClass("well-hidden")||(usersSecurityHidden=!1)}),usersSecurityHidden?($(".user-table").show(0),$(".user-well").removeClass("well-hidden"),$("#user-security-icon").text("-"),usersSecurityHidden=!1):($(".user-table").hide(0),$(".user-well").addClass("well-hidden"),$("#user-security-icon").text("+"),usersSecurityHidden=!0)})});var users=new HashTable,usernames=new HashTable,orphanedUserOpts=new HashTable,securityGroups=new HashTable,secGroupPorts=[],tcpPorts=[],udpPorts=[],tcpString="",udpString="",icmp="";$(function(){checkAddUser()});