{% extends "coal/base-fluid.html" %}

{% block title %} Project View{% endblock %}
{% block javascripts %}
    <link rel="stylesheet" href="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/themes/base/jquery.ui.all.css">
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.core.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.widget.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.mouse.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.button.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.draggable.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.position.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.resizable.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.button.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.dialog.js"></script>
    <script src="{{ STATIC_URL }}javascripts/jquery-ui-1.10.3/ui/jquery.ui.effect.js"></script>
    <script src="{{ STATIC_URL }}javascripts/project_view/create_user.js"/></script>
    <script src="{{ STATIC_URL }}javascripts/project_view/add_existing_user.js"/></script>
    <script src="{{ STATIC_URL }}javascripts/project_view/update-password.js"/></script>
    <script>
      var PROJECT = "{{ project.project_name}}";
    </script>
<script>
$(document).ready(function() {
	$('a[data-confirm]').click(function(ev) {
		var href = $(this).attr('href');
		if (!$('#dataConfirmModal').length) {
			$('body').append('<div id="dataConfirmModal" class="modal" role="dialog" aria-labelledby="dataConfirmLabel" aria-hidden="true"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button><h3 id="dataConfirmLabel">Please Confirm</h3></div><div class="modal-body"></div><div class="modal-footer"><button class="btn" data-dismiss="modal" aria-hidden="true">Cancel</button><a class="btn btn-primary" id="dataConfirmOK">OK</a></div></div>');
		} 
		$('#dataConfirmModal').find('.modal-body').text($(this).attr('data-confirm'));
		$('#dataConfirmOK').attr('href', href);
		$('#dataConfirmModal').modal({show:true});
		return false;
	});
});
</script>


{% endblock %}

{% block content %}
{% load extratags %}

    <div class="span12 well legend-header">
        {{ project.project_name}} ({{project.project_id}}) <a href="/projects/{{project.id}}/delete" data-confirm="Are you sure you want to delete?" class="btn btn-danger" style="float:right"><i class="icon-white icon-trash"></i> Delete Project</a>
    </div>

    <!--<b>def_security_group_name</b>: {{project.def_security_group_name}}<br>
    <b>def_security_key_name</b>: {{project.def_security_key_name}}<br>
    <b>host_system_name</b>: {{project.host_system_name}}<br>
    <b>project_name</b>: {{project.project_name}}<br>
    <b>def_network_id</b>: {{project.def_network_id}}<br>
    <b>def_security_key_id</b>: {{project.def_security_key_id}}<br>
    <b>host_system_ip</b>: {{project.host_system_ip}}<br>
    <b>def_network_name</b>: {{project.def_network_name}}<br>
    <b>project_id</b>: {{project.project_id}}<br>
    <b>def_security_group_id</b>: {{project.def_security_group_id}}<br>-->
    
    <!--  Begin Row One -->
    <div class="row-fluid"> 
    
      <!-- Begin user widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Users   <a href="#"  id="create-user" class="btn btn-mini" style="float:right"><i class="icon-plus"></i> New User</a>
             {% if ouserinfo%}
                <a href="#" id="add-existing-user" class="btn btn-mini" style="float:right"><i class="icon-plus"></i> Add Existing User</a>
             {% endif %}
          </div>
          
          
          <div id="dialog-form" title="Create new user">
                <p class="validateTips">All form fields are required.</p>
                <form>
                {% csrf_token %}
                <fieldset>
                    <label for="name">Name</label>
                    <input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all" />
                    <label for="email">Email</label>
                    <input type="text" name="email" id="email" value="" class="text ui-widget-content ui-corner-all" />
                    <label for="password">Password</label>
                    <input type="password" name="password" id="password" value="" class="text ui-widget-content ui-corner-all" />
                    <select name="role" id="role">
                        <option value="user">User</option>
                        <option value="pu">Power User</option>
                        <option value="admin">Admin</option>
                    </select>
                </fieldset>
                </form>
            </div>
            
            <div id="dialog-form-add-existing-user" title="Add Existing user">
                <p class="validateTips">All form fields are required.</p>
                <form>
                {% csrf_token %}
                <fieldset>
                    <label for="name">Name</label>
                    <select name="name" id="name">
                        {% for ouser in ouserinfo %}
                            <option value="{{ouser}}">{{ouser}}</option>
                        {% endfor %}
                    </select>
                    <select name="role" id="role">
                        <option value="user">User</option>
                        <option value="pu">Power User</option>
                        <option value="admin">Admin</option>
                    </select>
                </fieldset>
                </form>
            </div>
            
            <div id="dialog-form-update-password" title="Update Password">
                <p class="validateTips">All form fields are required.</p>
                <form>
                {% csrf_token %}
                <fieldset>
                    <label for="password">Password</label>
                    <input type="password" name="password" id="password" value="" class="text ui-widget-content ui-corner-all" />
                    <label for="password1">Confirm Password</label>
                    <input type="password" name="password1" id="password1" value="" class="text ui-widget-content ui-corner-all" />
                </fieldset>
                </form>
            </div>
          
          <table class="paleblue" id="users">
                <tr> <th>User</th>  <th>Actions</th>  </tr>
                {% for pu in users %}
                  {% with pu.username as username %}
		    {% with userinfo|access:username as ui %}
			<tr id="{{username}}" {% if ui.user_enabled == "FALSE" %} class="user_disabled" {% endif %}> 
			  <td id="{{username}}_info">
			    {% if ui.user_enabled == "FALSE" %} 
			      <i class="icon-warning-sign"></i> 
			    {% endif %}
			    <b>{{username}}</b>   (<a href="mailto:{{ui.email}}">{{ui.email}}</a>) <span class="right">{{ui.user_role}}</span>
			    
			  </td>  

			  <td id="{{username}}_actions"><a href="/projects/{{ project.project_name}}/user/{{pu.username}}/view/">view</a> | <a href="/AJAX/delete_user/{{pu.username}}/{{ui.user_id}}/" data-confirm="This will completely erase {{pu.username}} from all projects. Are you sure?"> delete</a>| {% include "coal/toggle_user.html" %}    | <a href="/AJAX/remove_user_from_project/{{ui.user_id}}/{{ project.project_id}}/">remove user from project</a> | <a href="update_user_password">update password</a></td></tr>
                
                    {% endwith %}
                  {% endwith %}
                {% endfor %}
          </table>
          
        </div>
      </div>
      
      <!-- Begin Security Groups widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Security Groups
          </div>
	    <table class="paleblue">
		{% if sec_groups %}
		  <tr> <th>Security Group</th>  <th>Group Id</th>  <th>Owner</th></tr>
		    {% for sg in sec_groups %}
		      <tr> <td>{{sg}}</td>  <td></td>  <td></td></tr>
		    {% endfor %}
		{% else %}
		
		<p><i>This project has no security groups</i></p>
		{% endif %}
	  </table>
        </div>
      </div>

    <!-- Begin Key Pairs widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Key Pairs
          </div>
          <table class="paleblue">
	    {% if sec_keys %}
                <tr> <th>key_name</th> <th>key_id</th> <th>owner_name</th></tr>
                    {% for key in sec_keys %}
		      <tr> <td>{{key}}</td>  <td></td>  <td></td></tr>
		    {% endfor %}
		{% else %}
		  <p><i>This project has no keys</i></p>
		{% endif %}
          </table>

        </div>
      </div>

    </div>
    <!-- end row one-->
    
    <!-- begin row two -->
    <div class="row-fluid">  
    
      <!-- Begin volume widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Volume Storage
          </div>
           <table class="paleblue">
	    {% if volumes %}
                <tr> <th>volume</th> <th></th> <th></th></tr>
                    {% for volume in volumes %}
		      <tr> <td>{{volume}}</td>  <td></td>  <td></td></tr>
		    {% endfor %}
		{% else %}
		  <p><i>This project has no volumes</i></p>
		{% endif %}
          </table>
        </div>
      </div>
      
      <!-- Begin Containers widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Object Containers
          </div>
          <p> Not yet implemented.</p>
        </div>
      </div>
      
      <!-- Begin snapshots widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Snapshots
          </div>
          <table class="paleblue">
	    {% if snapshots %}
                <tr> <th>snapshots</th> <th></th> <th></th></tr>
                    {% for snapshot in snapshots %}
		      <tr> <td>{{snapshot}}</td>  <td></td>  <td></td></tr>
		    {% endfor %}
		{% else %}
		  <p><i>This project has no snapshots</i></p>
		{% endif %}
          </table>
        </div>
      </div>

    </div>
    <!-- end row two-->
    <!-- begin row three -->
    <div class="row-fluid">  
    
     <!-- Begin Network widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             External Networks
          </div>
          {% if networks %}
	    <table class="paleblue">
	    
                <tr> <th>Network</th>  <th>Network info</th>  </tr>
                
                {% for key,value in networks.items %}
		  {% if value.net_internal == 'false' %}
		    <tr> <td>{{key}}</td>  <td>{{value}}</td>  </tr>
		  {% endif %}
		  
		{% endfor %}
	    </table>
	  {% else %}	
	   <p><i>This project has no external networks</i></p>
	  {% endif %}
                         
        </div>
      </div>
      
      <!-- Begin Routers widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Routers
          </div>
	  {% if routers %}
	    <table class="paleblue">
	    
                <tr> <th>Router</th>  <th>Router Status</th>  </tr>
                
                {% for router in routers %}
		  
		    <tr> <td>{{router}}</td>  <td></td>  </tr>
		  
		{% endfor %}
	    </table>
	  {% else %}	
	   <p><i>This project has no routers</i></p>
	  {% endif %}
	  
         </div>                
      </div>

    <!-- Begin Private Networks widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Private Networks
          </div>
          {% if networks %}
	    <table class="paleblue">
	    
                <tr> <th>Network</th>  <th>Network info</th>  </tr>
                
                {% for key,value in networks.items %}
		  {% if value.net_internal == 'true' %}
		    <tr> <td>{{key}}</td>  <td>{{value}}</td>  </tr>
		  {% endif %}
		  
		{% endfor %}
	    </table>
	  {% else %}	
	   <p><i>This project has no private networks</i></p>
	  {% endif %}
        </div>
      </div>
    
    </div>
    <!-- end row three-->
    <!-- begin row four -->
    <div class="row-fluid">  
    
     <!-- Begin instance widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Instances
          </div>
	  {% if instances %}
	    <table class="paleblue">
	    
                <tr> <th>Instance</th>  <th></th>  </tr>
                
                {% for instance in instances %}
		  
		    <tr> <td>{{instance}}</td>  <td></td>  </tr>
		  
		{% endfor %}
	    </table>
	  {% else %}	
	   <p><i>This project has no instances</i></p>
	  {% endif %}
        </div>
      </div>
      
      <!-- Begin Floating IP widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Floating IP's
          </div>
          <p> Not yet implemented.</p>
        </div>
      </div>
      
      <!-- Begin image widget-->
      <div class="span4">
        <div class="well">
          <div class="legend">
             Images
          </div>
          {% if images %}
	    <table class="paleblue">
	    
                <tr> <th>Image</th>  <th></th>  </tr>
                
                {% for image in images %}
		  
		    <tr> <td>{{image}}</td>  <td></td>  </tr>
		  
		{% endfor %}
	    </table>
	  {% else %}	
	   <p><i>This project has no images.</i></p>
	  {% endif %}
        </div>
      </div>

    </div>
    <!-- end row four-->
       

      

   


{% endblock %}
