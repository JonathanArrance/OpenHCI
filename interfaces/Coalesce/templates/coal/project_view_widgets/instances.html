<!-- Begin instance widget-->
<div class="span4">
    <div class="well instance-management-well">
        <div class="legend">

            Instances

            <div id="instance_progressbar" class="ui-progressbar progressbar">
                <span class="progressbar-text">Working</span>
            </div>

            <a href="#" id="create-instance" class="btn" style="float:right; display: inline-block;">Create</a>
        </div>

        <div class="well-tall instance-management-table">
            <table class="paleblue widget-table table-tall" id="instance_list">
                <tr>
                    <th>Name</th>
                    <th>Status</th>
                    <th>OS / flavor</th>
                    <th>Actions</th>
                </tr>
                {% if instances %}
                    {% for k,v in instance_info.items %}
                        <tr id="{{ v.server_id }}"
                            class="{% if v.server_status == 'PAUSED' %}instance-paused{% endif %}{% if v.server_status == 'SUSPENDED' %}instance-suspended{% endif %}">
                            <td id="{{ v.server_id }}-name-cell">
                                <a href="/{{ project.project_id }}/{{ v.server_id }}/instance_view/"
                                   class="disable-link"><span
                                        id="{{ v.server_id }}-name-text">{{ v.server_name }}</span></a>
                            </td>
                            <td id="{{ v.server_id }}-status-cell">{{ v.server_status }}</td>
                            <td id="{{ v.server_id }}-os-cell">{{ v.server_os }} / {{ v.server_flavor }}</td>
                            <td id="{{ v.server_id }}-actions-cell">
                                {% if v.server_status == "ACTIVE" %}
                                    <a href="{{ v.novnc_console }}" class="open-instance-console"
                                       onClick="window.open(this.href,'',
                                   'toolbar=no, location=no, status=no, menubar=no, titlebar = no, scrollbars=yes, resizable=yes, width=720, height=435');
                        return false;">console</a>
                                    <span class="instance-actions-pipe"> | </span>
                                    <a href="#" class="pause-instance">pause</a>
                                    <span class="instance-actions-pipe"> | </span>
                                    <a href="#" class="suspend-instance">suspend</a>
                                    <span class="instance-actions-pipe"> | </span>
                                    <a href="#" class="delete-instance">delete</a>
                                {% elif v.server_status == "PAUSED" %}
                                    <a href="#" class="unpause-instance">unpause</a>
                                    <span class="instance-actions-pipe"> | </span>
                                    <a href="#" class="delete-instance">delete</a>
                                {% elif v.server_status == "SUSPENDED" %}
                                    <a href="#" class="resume-instance">resume</a>
                                    <span class="instance-actions-pipe"> | </span>
                                    <a href="#" class="delete-instance">delete</a>
                                {% else %}
                                    <a href="#" class="delete-instance">delete</a>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                {% else %}
                    <tr id="instance_placeholder">
                        <td><p><i>This project has no instances</i></p></td>
                        <td></td>
                        <td></td>
                        <td></td>
                    </tr>
                {% endif %}
            </table>
        </div>
    </div>
</div>
<!-- ---------- DECLARE GLOBAL VARIABLES ---------- -->

{% if instances %}
    {% for k,v in instance_info.items %}
        <script>
            instances.setItem("{{v.server_id}}", {
                id: "{{v.server_id}}",
                name: "{{v.server_name}}",
                status: "{{v.server_status}}",
                flavor: "{{v.server_flavor}}",
                os: "{{v.server_os}}",
                console: "{{v.novnc_console}}"
            });
            instanceOpts.setItem("{{v.server_id}}", {
                value: "{{v.server_id}}",
                option: "{{v.server_name}}"
            });
            consoleLinks.setItem("{{v.server_id}}", {
                link: "{{v.novnc_console}}",
                html: '<a href=\"{{v.novnc_console}}\" class=\"open-instance-console\" onClick=\"window.open(this.href,\'_blank\',\'toolbar=no, location=no, status=no, menubar=no, titlebar = no, scrollbars=yes, resizable=yes, width=720, height=435\'); return false;\">console</a>'
            });
        </script>
    {% endfor %}
{% endif %}

{% for sg in sec_groups %}
    <script>
        secGroupInstOpts.setItem("{{sg.sec_group_name}}", {
            value: "{{sg.sec_group_name}}",
            option: "{{sg.sec_group_name}}"
        });
    </script>
{% endfor %}

{% for sk in sec_keys %}
    <script>
        secKeyInstOpts.setItem("{{sk.key_name}}", {
            value: "{{sk.key_name}}",
            option: "{{sk.key_name}}",
            id: "{{ sk.key_id }}"
        });
    </script>
{% endfor %}

{% for net in priv_net_list %}
    <script>
        privNetInstOpts.setItem("{{net.net_name}}", {
            value: "{{net.net_name}}",
            option: "{{net.net_name}}"
        });
    </script>
{% endfor %}

{% for image in images %}
    <script>
        imageInstOpts.setItem("{{image.image_name}}", {
            value: "{{image.image_name}}",
            option: "{{image.image_name}}"
        });
    </script>
{% endfor %}

{% for flavor in flavors %}
    <script>
        flavors.setItem("{{flavor.flavor_name}}", {
            value: "{{flavor.flavor_name}}",
            option: "{{flavor.flavor_name}}"
        });
    </script>
{% endfor %}
