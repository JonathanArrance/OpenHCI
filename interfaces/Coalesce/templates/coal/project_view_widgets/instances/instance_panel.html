{% if error %}
    <script>showMessage('error', "{{ error }}");</script>
{% endif %}

<h3 class="row-header">Instances</h3>

<div class="row-fluid">
    <div class="col-sm-6">
        <table class="table table-striped table-hover table-responsive table-bordered">
            <thead>
            <tr class="bg-primary">
                <th>Instance</th>
                <th>Status</th>
                <th>
                    <button id="create-instance" class="btn btn-xs btn-success pull-right"><i class="fa fa-plus"></i>
                    </button>
                </th>
            </tr>
            </thead>
            <tbody>
            {% if instances %}
                {% for instance in instances %}
                    <tr id="{{ instance.server_id }}"
                        class="instance">
                        <td class="instance-name">
                            <button data-call="/{{ project.project_id }}/{{ instance.server_id }}/instance_view/"
                               data-refresh="/projects/{{ project.project_id }}/get_instance_panel/"
                               data-toggle="tooltip" data-placement="bottom"
                               title="ID: {{ instance.server_id }}" class="btn btn-wide btn-xs btn-social btn-light">
                                <i class="fa fa-info-circle"></i>{{ instance.server_name }}
                            </button>
                        </td>
                        <td class="instance-status center-text {% if instance.status == "ACTIVE" %}bg-success{% elif instance.status == "PAUSED" or instance.status == "SUSPENDED" or instance.status == "BUILDING" %}bg-warning{% elif instance.status == "ERROR" %}bg-danger{% endif %}">
                            {{ instance.status }}</td>
                        <td class="instance-actions">
                            <div class="btn-group actions-dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                   aria-expanded="false">
                                    actions
                                    <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu table-dropdown">
                                    {% if instance.status == "ACTIVE" %}
                                        <li>
                                            <a href="#"
                                               onClick="window.open({{ instance.info.novnc_console }},'', 'toolbar=no, location=no, status=no, menubar=no, titlebar = no, scrollbars=yes, resizable=yes, width=720, height=435');return false;">
                                                console</a>
                                        </li>
                                        <li><a href="#" class="pause-instance">pause</a></li>
                                        <li><a href="#" class="suspend-instance">suspend</a></li>
                                        <li><a href="#" class="delete-instance">delete</a></li>
                                    {% elif instance.status == "PAUSED" %}
                                        <li><a href="#" class="unpause-instance">unpause</a></li>
                                        <li><a href="#" class="delete-instance">delete</a></li>
                                    {% elif instance.status == "SUSPENDED" %}
                                        <li><a href="#" class="resume-instance">resume</a></li>
                                        <li><a href="#" class="delete-instance">delete</a></li>
                                    {% else %}
                                        <li><a href="#" class="delete-instance">delete</a></li>
                                    {% endif %}
                                </ul>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr class="instance-placeholder text-warning">
                    <td><p><i>This project has no instances</i></p></td>
                    <td></td>
                    <td></td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
    <div class="col-sm-6">
        <div class="panel panel-primary">
            <div class="panel-heading">
                <h3 class="panel-title">Instance Statistics</h3>
            </div>
            <div class="panel-body center-text">
                <span id="instance-stats">
                    <script>
                        generateQuotaPie("instance-stats", [['used', "{{ tenant_info.num_instances }}"], ['available', "{{ quota.instances }}"]], "# Instances");
                    </script>
                </span>
                <span id="fip-stats">
                    <script>
                        generateQuotaPie("fip-stats", [['used', "{{ tenant_info.num_fips }}"], ['available', "{{ quota.floating_ips }}"]], "# Floating IPs");
                    </script>
                </span>
            </div>
        </div>
    </div>
</div>

<h3 class="row-header">Images and Flavors</h3>

<div class="row-fluid">
    <div class="col-sm-6">
        <table class="table table-striped table-hover table-responsive table-bordered">
            <thead class="bg-primary">
            <tr>
                <th>Image</th>
                <th>
                    <button id="import-image" class="btn btn-xs btn-success pull-right"><i class="fa fa-plus"></i>
                    </button>
                </th>
            </tr>
            </thead>
            <tbody>
            {% if images %}
                {% for image in images %}
                    <tr id="{{ image.image_id }}" class="image">
                        <td class="image-name">
                            <span data-toggle="tooltip" data-placement="right"
                                  title="ID: {{ image.image_id }}">{{ image.image_name }}</span>
                        </td>
                        <td class="image-actions">
                            <div class="btn-group actions-dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                   aria-expanded="false">
                                    actions
                                    <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu table-dropdown">
                                    <li>
                                        <a href="#" class="delete-image">delete</a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr class="image-placeholder text-warning">
                    <td><p><i>This project has no images.</i></p></td>
                    <td></td>
                </tr>
            {% endif %}</tbody>
        </table>
    </div>
    <div class="col-sm-6">
        <table class="table table-striped table-hover table-responsive table-bordered">
            <thead class="bg-primary">
            <tr>
                <th>Flavor</th>
                <th>Memory (mb)</th>
                <th>Space (gb)</th>
                <th>CPUs</th>
                <th>
                    <button id="create-flavor" class="btn btn-xs btn-success pull-right"><i class="fa fa-plus"></i>
                    </button>
                </th>
            </tr>
            </thead>
            <tbody>
            {% if flavors %}
                {% for flavor in flavors %}
                    <tr id="{{ flavor.id }}" class="snapshot">
                        <td class="flavor-name">
                            <span data-toggle="tooltip" data-placement="right"
                                  title="ID: {{ flavor.id }}">{{ flavor.name }}</span>
                        </td>
                        <td class="flavor-memory">
                            {{ flavor.info.memory }}
                        </td>
                        <td class="flavor-space">
                            <span class="text-info">disk: <span>{{ flavor.info.disk_space }}</span></span>
                        </td>
                        <td class="flavor-cpus">
                            {{ flavor.info.cpus }}
                        </td>
                        <td class="flavor-actions">
                            <div class="btn-group actions-dropdown">
                                <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button"
                                   aria-expanded="false">
                                    actions
                                    <span class="caret"></span>
                                </a>
                                <ul class="dropdown-menu table-dropdown">
                                    <li>
                                        <a href="#" class="delete-flavor">delete</a>
                                    </li>
                                </ul>
                            </div>
                        </td>
                    </tr>
                {% endfor %}
            {% else %}
                <tr class="flavor-placeholder text-warning">
                    <td><p><i>This project has no flavors.</i></p></td>
                    <td></td>
                    <td></td>
                    <td></td>
                    <td></td>
                </tr>
            {% endif %}
            </tbody>
        </table>
    </div>
</div>
<script>
    $('[data-toggle="tooltip"]').tooltip();
</script>